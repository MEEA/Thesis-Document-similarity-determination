{
  "datasourceIdentifier" : "awesome wiki export",
  "backlink" : "http://en.wikipedia.org/?curid=3876",
  "eid" : "c99256a0-52b1-11e8-ad1f-273b2f3b71fa",
  "loadTime" : 1525778417930,
  "textBody" : "| kurtosis   = \\frac{1-6p(1-p)}{np(1-p)}\n  | entropy    = \\frac12 \\log_2 \\big( 2\\pi e\\, np(1-p) \\big) + O \\left( \\frac{1}{n} \\right) in shannons. For nats, use the natural log in the log.\n  | mgf        = (1-p + pe^t)^n \\!\n  | char       = (1-p + pe^{it})^n \\!\n  | pgf        G(z) \n \\left[(1-p) + pz\\right]^n.\n  | fisher      g_n(p) \n \\frac{n}{p(1-p)} \n\n(for fixed n)\n  }}\n\nIn probability theory and statistics, the binomial distribution with parameters n and p is the discrete probability distribution of the number of successes in a sequence of n independent experiments, each asking a yes–no question, and each with its own boolean-valued outcome: a random variable containing single bit of information: success/yes/true/one (with probability p) or failure/no/false/zero (with probability q = 1 − p). \nA single success/failure experiment is also called a Bernoulli trial or Bernoulli experiment and a sequence of outcomes is called a Bernoulli process; for a single trial, i.e., n = 1, the binomial distribution is a Bernoulli distribution. The binomial distribution is the basis for the popular binomial test of statistical significance.\n\nThe binomial distribution is frequently used to model the number of successes in a sample of size n drawn with replacement from a population of size N. If the sampling is carried out without replacement, the draws are not independent and so the resulting distribution is a hypergeometric distribution, not a binomial one.  However, for N much larger than n, the binomial distribution remains a good approximation, and is widely used.\n\nSpecification\n\nProbability mass function\n\nIn general, if the random variable X follows the binomial distribution with parameters n ∈ ℕ and p ∈ [0,1], we write X ~ B(n, p). The probability of getting exactly k successes in n trials is given by the probability mass function:\n\nPr(k;n,p) \\Pr(X \n k) = {n\\choose k}p^k(1-p)^{n-k}\n\nfor k = 0, 1, 2, ..., n, where\n\n\\binom n k =\\frac{n!}{k!(n-k)!}\n\nis the binomial coefficient, hence the name of the distribution. The formula can be understood as follows. k successes occur with probability pk and n − k failures occur with probability (1 − p)n − k. However, the k successes can occur anywhere among the n trials, and there are  {n\\choose k}different ways of distributing k successes in a sequence of n trials.\n\nIn creating reference tables for binomial distribution probability, usually the table is filled in up to n/2 values. This is because for k > n/2, the probability can be calculated by its complement as\n\nf(k,n,p)=f(n-k,n,1-p). \n\nLooking at the expression ƒ(k, n, p) as a function of k, there is a k value that maximizes it. This k value can be found by calculating\n \\frac{f(k+1,n,p)}{f(k,n,p)}=\\frac{(n-k)p}{(k+1)(1-p)} \nand comparing it to 1. There is always an integer M that satisfies\n\n(n+1)p-1 \\leq M \n\nƒ(k, n, p) is monotone increasing for k  M, with the exception of the case where (n + 1)p is an integer. In this case, there are two values for which ƒ is maximal: (n + 1)p and (n + 1)p − 1. M is the most probable (most likely) outcome of the Bernoulli trials and is called the mode. Note that the probability of it occurring can be fairly small.\n\nCumulative distribution function\n\nThe cumulative distribution function can be expressed as:\n\nF(k;n,p) \\Pr(X \\le k) \n \\sum_{i=0}^{\\lfloor k \\rfloor} {n\\choose i}p^i(1-p)^{n-i}\n\nwhere \\scriptstyle \\lfloor k\\rfloor\\, is the \"floor\" under k, i.e. the greatest integer less than or equal to k.\n\nIt can also be represented in terms of the regularized incomplete beta function, as follows:\n\n\\begin{align}\nF(k;n,p) & = \\Pr(X \\le k) \\\\\n&= I_{1-p}(n-k, k+1) \\\\\n& = (n-k) {n \\choose k} \\int_0^{1-p} t^{n-k-1} (1-t)^k \\, dt.\n\\end{align}\n\nSome closed-form bounds for the cumulative distribution function are given below.\n\nExample\n\nSuppose a biased coin comes up heads with probability 0.3 when tossed. What is the probability of achieving 0, 1,..., 6 heads after six tosses?\n\n\\Pr(0\\text{ heads}) f(0) \n \\Pr(X 0) \n {6\\choose 0}0.3^0 (1-0.3)^{6-0}= 0.117649\n\\Pr(1\\text{ heads}) f(1) \n \\Pr(X 1) \n {6\\choose 1}0.3^1 (1-0.3)^{6-1}= 0.302526\n\\Pr(2\\text{ heads}) f(2) \n \\Pr(X 2) \n {6\\choose 2}0.3^2 (1-0.3)^{6-2}= 0.324135\n\\Pr(3\\text{ heads}) f(3) \n \\Pr(X 3) \n {6\\choose 3}0.3^3 (1-0.3)^{6-3}= 0.18522\n\\Pr(4\\text{ heads}) f(4) \n \\Pr(X 4) \n {6\\choose 4}0.3^4 (1-0.3)^{6-4}= 0.059535\n\\Pr(5\\text{ heads}) f(5) \n \\Pr(X 5) \n {6\\choose 5}0.3^5 (1-0.3)^{6-5}= 0.010206\n\\Pr(6\\text{ heads}) f(6) \n \\Pr(X 6) \n {6\\choose 6}0.3^6 (1-0.3)^{6-6}= 0.000729Hamilton Institute. [http://www.hamilton.ie/ollie/EE304/Binom.pdf \"The Binomial Distribution\"] October 20, 2010.\n\nMean\n\nIf X ~ B(n, p), that is, X is a binomially distributed random variable, n being the total number of experiments and p the probability of each experiment yielding a successful result, then the expected value of X is:See [https://proofwiki.org/wiki/Expectation_of_Binomial_Distribution Proof Wiki]\n\n \\operatorname{E}[X] = np.\n\nFor example, if n 100, and p \n1/4, then the average number of successful results will be 25.\n\nProof: We calculate the mean, μ, directly calculated from its definition \n\n\\mu\\sum_{i\n0}^n x_i p_i, \n\nand the binomial theorem:\n\n\\begin{align}\n \\mu &\\sum_{k\n0}^n k\\binom nk p^k (1-p)^{n-k}\\\\\n                     &np\\sum_{k\n0}^n k\\frac{(n-1)!}{(n-k)!k!}p^{k-1} (1-p)^{(n-1)-(k-1)}\\\\\n                     &np\\sum_{k\n1}^n \\frac{(n-1)!}{((n-1)-(k-1))!(k-1)!}p^{k-1} (1-p)^{(n-1)-(k-1)}\\\\\n                     &np\\sum_{k\n1}^n \\binom{n-1}{k-1} p^{k-1} (1-p)^{(n-1)-(k-1)}\\\\\n                     &np\\sum_{\\ell\n0}^{n-1} \\binom{n-1}\\ell p^\\ell (1-p)^{(n-1)-\\ell} && \\text{with } \\ell:=k-1\\\\\n                     &np\\sum_{\\ell\n0}^m \\binom m\\ell p^\\ell (1-p)^{m-\\ell} && \\text{with } m:=n-1\\\\\n                     &= np(p+(1-p))^m \\\\\n                     &=np\n\\end{align}\n\nIt is also possible to deduce the mean from the equation XX_1+\\cdots+X_n whereby all X_i are Bernoulli distributed random variables with E[X_i]\np (X_i1 if the i experiment succeed and X_i\n0 otherwise). We get:\nE[X] E[X_1+\\cdots+X_n] \n E[X_1]+\\cdots+E[X_n] \\underbrace{p+\\cdots+p}_{n\\text{ times}} \n np\n\nVariance\n\nThe variance is:\n \\operatorname{Var}(X) = np(1 - p).\n\nProof: Let XX_1+\\cdots+X_n where all X_i are independently Bernoulli distributed random variables. Since \\operatorname{Var}(X_i) \n p(1-p), we get:\n\n\\operatorname{Var}(X)\\operatorname{Var}(X_1+\\cdots+X_n)\n\\operatorname{Var}(X_1)+\\cdots+\\operatorname{Var}(X_n)n \\operatorname{Var}(X_1)\nnp(1-p).\n\nMode\n\nUsually the mode of a binomial B(n, p) distribution is equal to \\lfloor (n+1)p\\rfloor, where  \\lfloor\\cdot\\rfloor is the floor function. However, when (n + 1)p is an integer and p is neither 0 nor 1, then the distribution has two modes: (n + 1)p and (n + 1)p − 1. When p is equal to 0 or 1, the mode will be 0 and n correspondingly. These cases can be summarized as follows:\n\\text{mode} =\n      \\begin{cases}\n        \\lfloor (n+1)\\,p\\rfloor & \\text{if }(n+1)p\\text{ is 0 or a noninteger}, \\\\\n        (n+1)\\,p\\ \\text{ and }\\ (n+1)\\,p - 1 &\\text{if }(n+1)p\\in\\{1,\\dots,n\\}, \\\\\n        n & \\text{if }(n+1)p = n + 1.\n      \\end{cases}\n\nProof: Let \n\nf(k)=\\binom nk p^k q^{n-k}. \n\nFor p0 only f(0) has a nonzero value with f(0)\n1. For p1 we find f(n)\n1 and f(k)0 for k\\neq n. This proves that the mode is 0 for p\n0 and n for p=1.\n\nLet 0 . We find \n\n\\frac{f(k+1)}{f(k)} = \\frac{(n-k)p}{(k+1)(1-p)}. \n\nFrom this follows\n\n\\begin{align}\nk > (n+1)p-1 \\Rightarrow f(k+1)  f(k)\n\\end{align}\n\nSo when (n+1)p-1 is an integer, then (n+1)p-1 and (n+1)p is a mode. In the case that (n+1)p-1\\notin \\Z, then only \\lfloor (n+1)p-1\\rfloor+1=\\lfloor (n+1)p\\rfloor is a mode.See also [http://math.stackexchange.com/a/117940/32951 the answer to the question \"finding mode in Binomial distribution\"]\n\nMedian\n\nIn general, there is no single formula to find the median for a binomial distribution, and it may even be non-unique. However several special results have been established:\n* If np is an integer, then the mean, median, and mode coincide and equal np.Lord, Nick. (July 2010). \"Binomial averages when the mean is an integer\", The Mathematical Gazette 94, 331-332.\n* Any median m must lie within the interval ⌊np⌋ ≤ m ≤ ⌈np⌉.\n* A median m cannot lie too far away from the mean: }.\n* The median is unique and equal to m  round(np) in cases when either  or  or |m − np| ≤ min{p, 1 − p} (except for the case when p \n ½ and n is odd).\n* When p  1/2 and n is odd, any number m in the interval ½(n − 1) ≤ m ≤ ½(n + 1) is a median of the binomial distribution. If p \n 1/2 and n is even, then m = n/2 is the unique median.\n\nCovariance between two binomials\n\nIf two binomially distributed random variables X and Y are observed together, estimating their covariance can be useful. The covariance is\n\n\\operatorname{Cov}(X, Y) = \\operatorname{E}(XY) - \\mu_X \\mu_Y.\n\nIn the case n = 1 (the case of Bernoulli trials) XY is non-zero only when both X and Y are one, and μX and μY are equal to the two probabilities. Defining pB as the probability of both happening at the same time, this gives\n\n\\operatorname{Cov}(X, Y) = p_B - p_X p_Y,\n\nand for n independent pairwise trials\n\n\\operatorname{Cov}(X, Y)_n = n ( p_B - p_X p_Y ).\n\nIf X and Y are the same variable, this reduces to the variance formula given above.\n\nRelated distributions\n\nSums of binomials\n\nIf X ~ B(n, p) and Y ~ B(m, p) are independent binomial variables with the same probability p, then X + Y  is again a binomial variable; its distribution is Z=X+Y ~ B(n+m, p):\n\n\\begin{align}\n  \\operatorname P(Zk) &\n \\sum_{i=0}^k\\left[\\binom{n}i p^i (1-p)^{n-i}\\right]\\left[\\binom{m}{k-i} p^{k-i} (1-p)^{m-k+i}\\right]\\\\\n                       &= \\binom{n+m}k p^k (1-p)^{n+m-k}\n\\end{align}\n\nHowever, if X and Y do not have the same probability p, then the variance of the sum will be smaller than the variance of a binomial variable distributed as B(n+m, \\bar{p}).\\,\n\nRatio of two binomial distributions\n\nThis result was first derived by Katz et al in 1978.Katz D. et al.(1978) Obtaining confidence intervals for the risk ratio in cohort studies. Biometrics 34:469–474\n\nLet p1 and p2 be the probabilities of success in the binomial distributions B(X,n) and B(Y,m) respectively. Let T = (X/n)/(Y/m). \n\nThen log(T) is approximately normally distributed with mean log(p1/p2) and variance (1/x) - (1/n) + (1/y) - (1/m).\n\nReciprocal of binomial distribution\n\nNo closed form for this distribution is known. An asymptotic approximation for the mean is known.Cribari-Neto F, Lopes Garcia N, Vasconcellos KLP (2000) A note on inverse moments of binomial variates. Brazilian Review of Econometrics 20 (2)\t\n\n \\textrm{E}[ ( 1 + X )^a ] = O( ( np )^{ -a } ) + o( n^{ -a } ) \n\nwhere E[] is the expectation operator, X is a random variable, O() and o() are the big and little o order functions, n is the sample size, p is the probability of success and a is a variable that may be positive or negative, integer or fractional.\n\nConditional binomials\n\nIf X ~ B(n, p) and, conditional on X, Y ~ B(X, q), then Y is a simple binomial variable with distribution Y ~ B(n, pq).\n\nFor example, imagine throwing n balls to a basket UX and taking the balls that hit and throwing them to another basket UY. If p is the probability to hit UX then X ~ B(n, p) is the number of balls that hit UX. If q is the probability to hit UY then the number of balls that hit UY is Y ~ B(X, q) and therefore Y ~ B(n, pq).\n\nSince  X \\sim B(n, p)  and  Y \\sim B(X, q) , by the law of total probability,\n\n\\begin{align}\n\\Pr[Y m] &\n \\sum_{k m}^{n} \\Pr[Y \n m \\mid X k] \\Pr[X \n k] \\\\[2pt]\n&\\sum_{k\nm}^n \\binom{n}{k} \\binom{k}{m} p^k q^m (1-p)^{n-k} (1-q)^{k-m}\\\\\n\\end{align}\n\nSince  \\scriptstyle \\binom{n}{k} \\binom{k}{m} = \\binom{n}{m} \\binom{n-m}{k-m} , the equation above can be expressed as\n \\Pr[Y m] \n \\sum_{k=m}^{n} \\binom{n}{m} \\binom{n-m}{k-m} p^k q^m (1-p)^{n-k} (1-q)^{k-m} \nFactoring  p^k = p^m p^{k-m}  and pulling all the terms that don't depend on  k  out of the sum now yields\n \n\\begin{align}\n\\Pr[Y m] &\n \\binom{n}{m} p^m q^m \\left( \\sum_{k=m}^{n}  \\binom{n-m}{k-m} p^{k-m} (1-p)^{n-k} (1-q)^{k-m} \\right) \\\\[2pt]\n&\\binom{n}{m} (pq)^m \\left( \\sum_{k\nm}^{n}  \\binom{n-m}{k-m} \\left(p(1-q)\\right)^{k-m} (1-p)^{n-k}  \\right)\n\\end{align}\n\nAfter substituting  i = k - m  in the expression above, we get\n \\Pr[Y m] \n \\binom{n}{m} (pq)^m \\left( \\sum_{i=0}^{n-m} \\binom{n-m}{i} (p - pq)^i (1-p)^{n-m - i} \\right) \nNotice that the sum (in the parentheses) above equals  (p - pq + 1 - p)^{n-m}  by the binomial theorem. Substituting this in finally yields\n\n\\begin{align}\n\\Pr[Ym] &\n  \\binom{n}{m} (pq)^m (p - pq + 1 - p)^{n-m}\\\\[4pt]\n&= \\binom{n}{m} (pq)^m (1-pq)^{n-m}\n\\end{align}\n\nand thus  Y \\sim B(n, pq)  as desired.\n\nBernoulli distribution\n\nThe Bernoulli distribution is a special case of the binomial distribution, where n = 1. Symbolically, X ~ B(1, p) has the same meaning as X ~ B(p). Conversely, any binomial distribution, B(n, p), is the distribution of the sum of n Bernoulli trials, B(p), each with the same probability p.\n\nPoisson binomial distribution\n\nThe binomial distribution is a special case of the Poisson binomial distribution, or general binomial distribution, which is the distribution of a sum of n independent non-identical Bernoulli trials B(pi).\n\nNormal approximation\n\nIf n is large enough, then the skew of the distribution is not too great. In this case a reasonable approximation to B(n, p) is given by the normal distribution\n\n \\mathcal{N}(np,\\,np(1-p)),\n\nand this basic approximation can be improved in a simple way by using a suitable continuity correction.\nThe basic approximation generally improves as n increases (at least 20) and is better when p is not near to 0 or 1. Various rules of thumb may be used to decide whether n is large enough, and p is far enough from the extremes of zero or one:\n\n*One rule is that for  the normal approximation is adequate if the absolute value of the skewness is strictly less than 1/3; that is, if\n:\\frac{\\sqrt{np(1-p)}}=\\frac1{\\sqrt{n}}\\left|\\sqrt{\\frac{1-p}p}-\\sqrt{\\frac{p}{1-p}}\\,\\right|\n\n*A stronger rule states that the normal approximation is appropriate only if everything within 3 standard deviations of its mean is within the range of possible values; that is, only if\n:\\mu\\pm3\\sigma=np\\pm3\\sqrt{np(1-p)}\\in(0,n).\nThis 3-standard-deviation rule is equivalent to the following conditions, which also imply the first rule above.\n:n>9\\,\\frac{1-p}p\\quad\\hbox{and}\\quad n>9\\,\\frac{p}{1-p}.\n\nThe rule  np\\pm3\\sqrt{np(1-p)}\\in(0,n) is totally equivalent to request that\nnp-3\\sqrt{np(1-p)}>0\\quad\\hbox{and}\\quad np+3\\sqrt{np(1-p)}\nMoving terms around yields:\nnp>3\\sqrt{np(1-p)}\\quad\\hbox{and}\\quad n(1-p)>3\\sqrt{np(1-p)}.\nSince 0, we can apply the square power and divide by the respective factors np^2 and n(1-p)^2, to obtain the desired conditions:\nn>9\\,\\frac{1-p}p\\quad\\hbox{and}\\quad n>9\\,\\frac{p}{1-p}.\nNotice that these conditions automatically imply that n>9. On the other hand, apply again the square root and divide by 3,\n\\frac{\\sqrt{n}}3>\\sqrt{\\frac{1-p}p}>0\\quad\\hbox{and}\\quad\\frac{\\sqrt{n}}3>\\sqrt{\\frac{p}{1-p}}>0.\nSubtracting the second set of inequalities from the first one yields:\n\\frac{\\sqrt{n}}3>\\sqrt{\\frac{1-p}p}-\\sqrt{\\frac{p}{1-p}}>-\\frac{\\sqrt{n}}3;\nand so, the desired first rule is satisfied,\n\\left|\\sqrt{\\frac{1-p}p}-\\sqrt{\\frac{p}{1-p}}\\,\\right|\n\n*Another commonly used rule is that both values np and n(1-p) must be greater than or equal to 5. However, the specific number varies from source to source, and depends on how good an approximation one wants. In particular, if one uses 9 instead of 5, the rule implies the results stated in the previous paragraphs.\n\nAssume that both values np and n(1-p) are greater than 9. Since 0, we easily have that \nnp\\geq9>9(1-p)\\quad\\hbox{and}\\quad n(1-p)\\geq9>9p.\nWe only have to divide now by the respective factors p and 1-p, to deduce the alternative form of the 3-standard-deviation rule:\nn>9\\,\\frac{1-p}p\\quad\\hbox{and}\\quad n>9\\,\\frac{p}{1-p}.\n\nThe following is an example of applying a continuity correction. Suppose one wishes to calculate Pr(X ≤ 8) for a binomial random variable X. If Y has a distribution given by the normal approximation, then Pr(X ≤ 8) is approximated by Pr(Y ≤ 8.5). The addition of 0.5 is the continuity correction; the uncorrected normal approximation gives considerably less accurate results.\n\nThis approximation, known as de Moivre–Laplace theorem, is a huge time-saver when undertaking calculations by hand (exact calculations with large n are very onerous); historically, it was the first use of the normal distribution, introduced in Abraham de Moivre's book The Doctrine of Chances in 1738. Nowadays, it can be seen as a consequence of the central limit theorem since B(n, p) is a sum of n independent, identically distributed Bernoulli variables with parameter p. This fact is the basis of a hypothesis test, a \"proportion z-test\", for the value of p using x/n, the sample proportion and estimator of p, in a common test statistic.NIST/SEMATECH, [http://www.itl.nist.gov/div898/handbook/prc/section2/prc24.htm \"7.2.4. Does the proportion of defectives meet requirements?\"] e-Handbook of Statistical Methods.\n\nFor example, suppose one randomly samples n people out of a large population and ask them whether they agree with a certain statement. The proportion of people who agree will of course depend on the sample. If groups of n people were sampled repeatedly and truly randomly, the proportions would follow an approximate normal distribution with mean equal to the true proportion p of agreement in the population and with standard deviation \\sigma = \\sqrt{\\frac{p(1-p)}{n}}\n\nPoisson approximation\n\nThe binomial distribution converges towards the Poisson distribution as the number of trials goes to infinity while the product np remains fixed or at least p tends to zero. Therefore, the Poisson distribution with parameter λ np can be used as an approximation to B(n, p) of the binomial distribution if n is sufficiently large and p is sufficiently small.  According to two rules of thumb, this approximation is good if n ≥ 20 and p ≤ 0.05, or if n ≥ 100 and np ≤ 10.NIST/SEMATECH, [http://www.itl.nist.gov/div898/handbook/pmc/section3/pmc331.htm \"6.3.3.1. Counts Control Charts\"], e-Handbook of Statistical Methods.\n\nConcerning the accuracy of Poisson approximation, see Novak,Novak S.Y. (2011) Extreme value methods with applications to finance. London: CRC/ Chapman & Hall/Taylor & Francis. . ch. 4, and references therein.\n\nLimiting distributions\n\n* Poisson limit theorem: As n approaches ∞ and p approaches 0, then the Binomial(n, p) distribution approaches the Poisson distribution with expected value λ np.\n* de Moivre–Laplace theorem: As n approaches ∞ while p remains fixed, the distribution of\n\n:\\frac{X-np}{\\sqrt{np(1-p)}}\n\napproaches the normal distribution with expected value 0 and variance 1.  This result is sometimes loosely stated by saying that the distribution of X is asymptotically normal with expected value np and variance np(1 − p). This result is a specific case of the central limit theorem.\n\nBeta distribution\n\nBeta distributions  provide a family of prior probability distributions for binomial distributions in Bayesian inference:\nP(p;\\alpha,\\beta) = \\frac{p^{\\alpha-1}(1-p)^{\\beta-1}}{\\mathrm{B}(\\alpha,\\beta)}.\n\nConfidence intervals\n\nEven for quite large values of n, the actual distribution of the mean is significantly nonnormal. Because of this problem several methods to estimate confidence intervals have been proposed.\n\nIn the equations for confidence intervals below, the variables have the following meaning:\n\n* n1 is the number of successes out of n, the total number of trials\n*  \\hat{p} = \\frac{n_1}{n} is the proportion of successes\n* z is the 1 - \\tfrac{1}{2}\\alpha quantile of a standard normal distribution (i.e., probit) corresponding to the target error rate \\alpha. For example, for a 95% confidence level the error \\alpha  0.05, so 1 - \\tfrac{1}{2}\\alpha \n 0.975 and z = 1.96.\n\nWald method \n\n:  \\hat{p} \\pm z \\sqrt{ \\frac{ \\hat{p} ( 1 -\\hat{p} )}{ n } } .\n\nA continuity correction of 0.5/n may be added.\n\nAgresti-Coull method \n\n:  \\tilde{p} \\pm z \\sqrt{ \\frac{ \\tilde{p} ( 1 - \\tilde{p} )}{ n + z^2 } } .\n\nHere the estimate of p is modified to\n\n:  \\tilde{p}= \\frac{ n_1 + \\frac{1}{2} z^2}{ n + z^2 } \n\nArcSine methodPires MA [http://www.math.ist.utl.pt/~apires/PDFs/AP_COMPSTAT02.pdf Confidence intervals for a binomial proportion: comparison of methods and software evaluation.] \n\n:\\sin^2 \\left (\\arcsin \\left ( \\sqrt{ \\hat{p} } \\right ) \\pm \\frac{ z }{ 2 \\sqrt{ n } } \\right ) \n\nWilson (score) method\n\nThe notation in the formula below differs from the previous formula's in two respects:\n\n* Firstly, zx has a slightly different interpretation in the formula below: it has its ordinary meaning of 'the xth quantile of the standard normal distribution', rather than being a shorthand for 'the (1 - x)-th quantile'.\n\n* Secondly, this formula does not use a plus-minus to define the two bounds. Instead, one may use z z_{\\alpha / 2} to get the lower bound, or use z \n z_{1 - \\alpha/2} to get the upper bound. For example: for a 95% confidence level the error \\alpha  0.05, so one gets the lower bound by using z \n z_{\\alpha/2} z_{0.025} \n - 1.96, and one gets the upper bound by using z z_{1 - \\alpha/2} \n z_{0.975} = 1.96.\n\n\\frac{\n    \\hat{p} + \\frac{z^2}{2n} + z\n    \\sqrt{\n        \\frac{\\hat{p}(1 - \\hat{p})}{n} +\n        \\frac{z^2}{4 n^2}\n    }\n}{\n    1 + \\frac{z^2}{n}\n}\n\nComparison \n\nThe exact (Clopper-Pearson) method is the most conservative. \n\nThe Wald method, although commonly recommended in textbooks, is the most biased.\n\nGenerating binomial random variates\n\nMethods for random number generation where the marginal distribution is a binomial distribution are well-established.Devroye, Luc (1986) Non-Uniform Random Variate Generation, New York: Springer-Verlag. (See especially [http://luc.devroye.org/chapter_ten.pdf Chapter X, Discrete Univariate Distributions])\n\nOne way to generate random samples from a binomial distribution is to use an inversion algorithm. To do so, one must calculate the probability that P(X=k) for all values k from 0 through n. (These probabilities should sum to a value close to one, in order to encompass the entire sample space.) Then by using a pseudorandom number generator to generate samples uniformly between 0 and 1, one can transform the calculated samples U[0,1] into discrete numbers by using the probabilities calculated in step one.\n\nTail bounds\n\nFor k ≤ np, upper bounds for the lower tail of the distribution function can be derived.  Recall that F(k;n,p) = \\Pr(X \\le k), the probability that there are at most k successes.\n\nHoeffding's inequality yields the bound\n\n F(k;n,p) \\leq \\exp\\left(-2 \\frac{(np-k)^2}{n}\\right), \\!\n\nand Chernoff's inequality can be used to derive the bound\n\n F(k;n,p) \\leq \\exp\\left(-\\frac{1}{2\\,p} \\frac{(np-k)^2}{n}\\right). \\!\n\nMoreover, these bounds are reasonably tight when p = 1/2, since the following expression holds for all k ≥ 3n/8Matoušek, J, Vondrak, J: The Probabilistic Method (lecture notes) [https://www.cs.cmu.edu/afs/cs.cmu.edu/academic/class/15859-f09/www/handouts/matousek-vondrak-prob-ln.pdf].\n\n F(k;n,\\tfrac{1}{2}) \\leq \\frac{14}{15} \\exp\\left(- \\frac{16 (\\frac{n}{2} - k)^2}{n}\\right). \\!\n\nHowever, the bounds do not work well for extreme values of p. In particular, as p \\rightarrow 1, value F(k;n,p) goes to zero (for fixed k, n with kR. Arratia and L. Gordon: Tutorial on large deviations for the binomial distribution, Bulletin of Mathematical Biology 51(1) (1989), 125–131 [https://link.springer.com/article/10.1007%2FBF02458840].\n\n F(k;n,p) \\leq \\exp\\left(-nD\\left(\\frac{k}{n}\\left|\\right|p\\right)\\right) \\quad\\quad\\mbox{if }0\n\nwhere D(a || p) is the relative entropy between an a-coin and a p-coin (i.e. between the Bernoulli(a) and Bernoulli(p) distribution):\n\n D(a||p)=(a)\\log\\frac{a}{p}+(1-a)\\log\\frac{1-a}{1-p}. \\!\n\nAsymptotically, this bound is reasonably tight; see\n for details. An equivalent formulation of the bound is\n\n \\Pr(X \\ge k) =F(n-k;n,1-p)\\leq \\exp\\left(-nD\\left(\\frac{k}{n}\\left|\\right|p\\right)\\right) \\quad\\quad\\mbox{if }p\nBoth these bounds are derived directly from the Chernoff bound.\nIt can also be shown that,\n\n \\Pr(X \\ge k) =F(n-k;n,1-p)\\geq \\frac{1}{(n+1)^2} \\exp\\left(-nD\\left(\\frac{k}{n}\\left|\\right|p\\right)\\right) \\quad\\quad\\mbox{if }p\n\nThis is proved using the method of types (see for example chapter 12 of Elements of Information Theory by Cover and Thomas Theorem 11.1.3 in ).\n\nWe can also change the (n+1)^2 in the denominator to \\sqrt{2n}, by approximating the binomial coefficient with Stirling's formula.\n\nHistory\n\nThis distribution was derived by James Bernoulli in 1713. He considered the case where p r/(r+s) where p is the probability of success and r and s are positive integers. Blaise Pascal had earlier considered the case where p \n 1/2.",
  "entityProperties" : [ {
    "name" : "title",
    "type" : "String",
    "values" : [ "Binomial distribution" ],
    "synthetic" : false
  }, {
    "name" : "url",
    "type" : "String",
    "values" : [ "http://en.wikipedia.org/?curid=3876" ],
    "synthetic" : false
  } ],
  "classifications" : [ "xml-export" ],
  "technicalAttributes" : {
    "technicalAttributes" : null,
    "aggregatedText" : "| kurtosis   = \\frac{1-6p(1-p)}{np(1-p)}\n  | entropy    = \\frac12 \\log_2 \\big( 2\\pi e\\, np(1-p) \\big) + O \\left( \\frac{1}{n} \\right) in shannons. For nats, use the natural log in the log.\n  | mgf        = (1-p + pe^t)^n \\!\n  | char       = (1-p + pe^{it})^n \\!\n  | pgf        G(z) \n \\left[(1-p) + pz\\right]^n.\n  | fisher      g_n(p) \n \\frac{n}{p(1-p)} \n\n(for fixed n)\n  }}\n\nIn probability theory and statistics, the binomial distribution with parameters n and p is the discrete probability distribution of the number of successes in a sequence of n independent experiments, each asking a yes–no question, and each with its own boolean-valued outcome: a random variable containing single bit of information: success/yes/true/one (with probability p) or failure/no/false/zero (with probability q = 1 − p). \nA single success/failure experiment is also called a Bernoulli trial or Bernoulli experiment and a sequence of outcomes is called a Bernoulli process; for a single trial, i.e., n = 1, the binomial distribution is a Bernoulli distribution. The binomial distribution is the basis for the popular binomial test of statistical significance.\n\nThe binomial distribution is frequently used to model the number of successes in a sample of size n drawn with replacement from a population of size N. If the sampling is carried out without replacement, the draws are not independent and so the resulting distribution is a hypergeometric distribution, not a binomial one.  However, for N much larger than n, the binomial distribution remains a good approximation, and is widely used.\n\nSpecification\n\nProbability mass function\n\nIn general, if the random variable X follows the binomial distribution with parameters n ∈ ℕ and p ∈ [0,1], we write X ~ B(n, p). The probability of getting exactly k successes in n trials is given by the probability mass function:\n\nPr(k;n,p) \\Pr(X \n k) = {n\\choose k}p^k(1-p)^{n-k}\n\nfor k = 0, 1, 2, ..., n, where\n\n\\binom n k =\\frac{n!}{k!(n-k)!}\n\nis the binomial coefficient, hence the name of the distribution. The formula can be understood as follows. k successes occur with probability pk and n − k failures occur with probability (1 − p)n − k. However, the k successes can occur anywhere among the n trials, and there are  {n\\choose k}different ways of distributing k successes in a sequence of n trials.\n\nIn creating reference tables for binomial distribution probability, usually the table is filled in up to n/2 values. This is because for k > n/2, the probability can be calculated by its complement as\n\nf(k,n,p)=f(n-k,n,1-p). \n\nLooking at the expression ƒ(k, n, p) as a function of k, there is a k value that maximizes it. This k value can be found by calculating\n \\frac{f(k+1,n,p)}{f(k,n,p)}=\\frac{(n-k)p}{(k+1)(1-p)} \nand comparing it to 1. There is always an integer M that satisfies\n\n(n+1)p-1 \\leq M \n\nƒ(k, n, p) is monotone increasing for k  M, with the exception of the case where (n + 1)p is an integer. In this case, there are two values for which ƒ is maximal: (n + 1)p and (n + 1)p − 1. M is the most probable (most likely) outcome of the Bernoulli trials and is called the mode. Note that the probability of it occurring can be fairly small.\n\nCumulative distribution function\n\nThe cumulative distribution function can be expressed as:\n\nF(k;n,p) \\Pr(X \\le k) \n \\sum_{i=0}^{\\lfloor k \\rfloor} {n\\choose i}p^i(1-p)^{n-i}\n\nwhere \\scriptstyle \\lfloor k\\rfloor\\, is the \"floor\" under k, i.e. the greatest integer less than or equal to k.\n\nIt can also be represented in terms of the regularized incomplete beta function, as follows:\n\n\\begin{align}\nF(k;n,p) & = \\Pr(X \\le k) \\\\\n&= I_{1-p}(n-k, k+1) \\\\\n& = (n-k) {n \\choose k} \\int_0^{1-p} t^{n-k-1} (1-t)^k \\, dt.\n\\end{align}\n\nSome closed-form bounds for the cumulative distribution function are given below.\n\nExample\n\nSuppose a biased coin comes up heads with probability 0.3 when tossed. What is the probability of achieving 0, 1,..., 6 heads after six tosses?\n\n\\Pr(0\\text{ heads}) f(0) \n \\Pr(X 0) \n {6\\choose 0}0.3^0 (1-0.3)^{6-0}= 0.117649\n\\Pr(1\\text{ heads}) f(1) \n \\Pr(X 1) \n {6\\choose 1}0.3^1 (1-0.3)^{6-1}= 0.302526\n\\Pr(2\\text{ heads}) f(2) \n \\Pr(X 2) \n {6\\choose 2}0.3^2 (1-0.3)^{6-2}= 0.324135\n\\Pr(3\\text{ heads}) f(3) \n \\Pr(X 3) \n {6\\choose 3}0.3^3 (1-0.3)^{6-3}= 0.18522\n\\Pr(4\\text{ heads}) f(4) \n \\Pr(X 4) \n {6\\choose 4}0.3^4 (1-0.3)^{6-4}= 0.059535\n\\Pr(5\\text{ heads}) f(5) \n \\Pr(X 5) \n {6\\choose 5}0.3^5 (1-0.3)^{6-5}= 0.010206\n\\Pr(6\\text{ heads}) f(6) \n \\Pr(X 6) \n {6\\choose 6}0.3^6 (1-0.3)^{6-6}= 0.000729Hamilton Institute. [http://www.hamilton.ie/ollie/EE304/Binom.pdf \"The Binomial Distribution\"] October 20, 2010.\n\nMean\n\nIf X ~ B(n, p), that is, X is a binomially distributed random variable, n being the total number of experiments and p the probability of each experiment yielding a successful result, then the expected value of X is:See [https://proofwiki.org/wiki/Expectation_of_Binomial_Distribution Proof Wiki]\n\n \\operatorname{E}[X] = np.\n\nFor example, if n 100, and p \n1/4, then the average number of successful results will be 25.\n\nProof: We calculate the mean, μ, directly calculated from its definition \n\n\\mu\\sum_{i\n0}^n x_i p_i, \n\nand the binomial theorem:\n\n\\begin{align}\n \\mu &\\sum_{k\n0}^n k\\binom nk p^k (1-p)^{n-k}\\\\\n                     &np\\sum_{k\n0}^n k\\frac{(n-1)!}{(n-k)!k!}p^{k-1} (1-p)^{(n-1)-(k-1)}\\\\\n                     &np\\sum_{k\n1}^n \\frac{(n-1)!}{((n-1)-(k-1))!(k-1)!}p^{k-1} (1-p)^{(n-1)-(k-1)}\\\\\n                     &np\\sum_{k\n1}^n \\binom{n-1}{k-1} p^{k-1} (1-p)^{(n-1)-(k-1)}\\\\\n                     &np\\sum_{\\ell\n0}^{n-1} \\binom{n-1}\\ell p^\\ell (1-p)^{(n-1)-\\ell} && \\text{with } \\ell:=k-1\\\\\n                     &np\\sum_{\\ell\n0}^m \\binom m\\ell p^\\ell (1-p)^{m-\\ell} && \\text{with } m:=n-1\\\\\n                     &= np(p+(1-p))^m \\\\\n                     &=np\n\\end{align}\n\nIt is also possible to deduce the mean from the equation XX_1+\\cdots+X_n whereby all X_i are Bernoulli distributed random variables with E[X_i]\np (X_i1 if the i experiment succeed and X_i\n0 otherwise). We get:\nE[X] E[X_1+\\cdots+X_n] \n E[X_1]+\\cdots+E[X_n] \\underbrace{p+\\cdots+p}_{n\\text{ times}} \n np\n\nVariance\n\nThe variance is:\n \\operatorname{Var}(X) = np(1 - p).\n\nProof: Let XX_1+\\cdots+X_n where all X_i are independently Bernoulli distributed random variables. Since \\operatorname{Var}(X_i) \n p(1-p), we get:\n\n\\operatorname{Var}(X)\\operatorname{Var}(X_1+\\cdots+X_n)\n\\operatorname{Var}(X_1)+\\cdots+\\operatorname{Var}(X_n)n \\operatorname{Var}(X_1)\nnp(1-p).\n\nMode\n\nUsually the mode of a binomial B(n, p) distribution is equal to \\lfloor (n+1)p\\rfloor, where  \\lfloor\\cdot\\rfloor is the floor function. However, when (n + 1)p is an integer and p is neither 0 nor 1, then the distribution has two modes: (n + 1)p and (n + 1)p − 1. When p is equal to 0 or 1, the mode will be 0 and n correspondingly. These cases can be summarized as follows:\n\\text{mode} =\n      \\begin{cases}\n        \\lfloor (n+1)\\,p\\rfloor & \\text{if }(n+1)p\\text{ is 0 or a noninteger}, \\\\\n        (n+1)\\,p\\ \\text{ and }\\ (n+1)\\,p - 1 &\\text{if }(n+1)p\\in\\{1,\\dots,n\\}, \\\\\n        n & \\text{if }(n+1)p = n + 1.\n      \\end{cases}\n\nProof: Let \n\nf(k)=\\binom nk p^k q^{n-k}. \n\nFor p0 only f(0) has a nonzero value with f(0)\n1. For p1 we find f(n)\n1 and f(k)0 for k\\neq n. This proves that the mode is 0 for p\n0 and n for p=1.\n\nLet 0 . We find \n\n\\frac{f(k+1)}{f(k)} = \\frac{(n-k)p}{(k+1)(1-p)}. \n\nFrom this follows\n\n\\begin{align}\nk > (n+1)p-1 \\Rightarrow f(k+1)  f(k)\n\\end{align}\n\nSo when (n+1)p-1 is an integer, then (n+1)p-1 and (n+1)p is a mode. In the case that (n+1)p-1\\notin \\Z, then only \\lfloor (n+1)p-1\\rfloor+1=\\lfloor (n+1)p\\rfloor is a mode.See also [http://math.stackexchange.com/a/117940/32951 the answer to the question \"finding mode in Binomial distribution\"]\n\nMedian\n\nIn general, there is no single formula to find the median for a binomial distribution, and it may even be non-unique. However several special results have been established:\n* If np is an integer, then the mean, median, and mode coincide and equal np.Lord, Nick. (July 2010). \"Binomial averages when the mean is an integer\", The Mathematical Gazette 94, 331-332.\n* Any median m must lie within the interval ⌊np⌋ ≤ m ≤ ⌈np⌉.\n* A median m cannot lie too far away from the mean: }.\n* The median is unique and equal to m  round(np) in cases when either  or  or |m − np| ≤ min{p, 1 − p} (except for the case when p \n ½ and n is odd).\n* When p  1/2 and n is odd, any number m in the interval ½(n − 1) ≤ m ≤ ½(n + 1) is a median of the binomial distribution. If p \n 1/2 and n is even, then m = n/2 is the unique median.\n\nCovariance between two binomials\n\nIf two binomially distributed random variables X and Y are observed together, estimating their covariance can be useful. The covariance is\n\n\\operatorname{Cov}(X, Y) = \\operatorname{E}(XY) - \\mu_X \\mu_Y.\n\nIn the case n = 1 (the case of Bernoulli trials) XY is non-zero only when both X and Y are one, and μX and μY are equal to the two probabilities. Defining pB as the probability of both happening at the same time, this gives\n\n\\operatorname{Cov}(X, Y) = p_B - p_X p_Y,\n\nand for n independent pairwise trials\n\n\\operatorname{Cov}(X, Y)_n = n ( p_B - p_X p_Y ).\n\nIf X and Y are the same variable, this reduces to the variance formula given above.\n\nRelated distributions\n\nSums of binomials\n\nIf X ~ B(n, p) and Y ~ B(m, p) are independent binomial variables with the same probability p, then X + Y  is again a binomial variable; its distribution is Z=X+Y ~ B(n+m, p):\n\n\\begin{align}\n  \\operatorname P(Zk) &\n \\sum_{i=0}^k\\left[\\binom{n}i p^i (1-p)^{n-i}\\right]\\left[\\binom{m}{k-i} p^{k-i} (1-p)^{m-k+i}\\right]\\\\\n                       &= \\binom{n+m}k p^k (1-p)^{n+m-k}\n\\end{align}\n\nHowever, if X and Y do not have the same probability p, then the variance of the sum will be smaller than the variance of a binomial variable distributed as B(n+m, \\bar{p}).\\,\n\nRatio of two binomial distributions\n\nThis result was first derived by Katz et al in 1978.Katz D. et al.(1978) Obtaining confidence intervals for the risk ratio in cohort studies. Biometrics 34:469–474\n\nLet p1 and p2 be the probabilities of success in the binomial distributions B(X,n) and B(Y,m) respectively. Let T = (X/n)/(Y/m). \n\nThen log(T) is approximately normally distributed with mean log(p1/p2) and variance (1/x) - (1/n) + (1/y) - (1/m).\n\nReciprocal of binomial distribution\n\nNo closed form for this distribution is known. An asymptotic approximation for the mean is known.Cribari-Neto F, Lopes Garcia N, Vasconcellos KLP (2000) A note on inverse moments of binomial variates. Brazilian Review of Econometrics 20 (2)\t\n\n \\textrm{E}[ ( 1 + X )^a ] = O( ( np )^{ -a } ) + o( n^{ -a } ) \n\nwhere E[] is the expectation operator, X is a random variable, O() and o() are the big and little o order functions, n is the sample size, p is the probability of success and a is a variable that may be positive or negative, integer or fractional.\n\nConditional binomials\n\nIf X ~ B(n, p) and, conditional on X, Y ~ B(X, q), then Y is a simple binomial variable with distribution Y ~ B(n, pq).\n\nFor example, imagine throwing n balls to a basket UX and taking the balls that hit and throwing them to another basket UY. If p is the probability to hit UX then X ~ B(n, p) is the number of balls that hit UX. If q is the probability to hit UY then the number of balls that hit UY is Y ~ B(X, q) and therefore Y ~ B(n, pq).\n\nSince  X \\sim B(n, p)  and  Y \\sim B(X, q) , by the law of total probability,\n\n\\begin{align}\n\\Pr[Y m] &\n \\sum_{k m}^{n} \\Pr[Y \n m \\mid X k] \\Pr[X \n k] \\\\[2pt]\n&\\sum_{k\nm}^n \\binom{n}{k} \\binom{k}{m} p^k q^m (1-p)^{n-k} (1-q)^{k-m}\\\\\n\\end{align}\n\nSince  \\scriptstyle \\binom{n}{k} \\binom{k}{m} = \\binom{n}{m} \\binom{n-m}{k-m} , the equation above can be expressed as\n \\Pr[Y m] \n \\sum_{k=m}^{n} \\binom{n}{m} \\binom{n-m}{k-m} p^k q^m (1-p)^{n-k} (1-q)^{k-m} \nFactoring  p^k = p^m p^{k-m}  and pulling all the terms that don't depend on  k  out of the sum now yields\n \n\\begin{align}\n\\Pr[Y m] &\n \\binom{n}{m} p^m q^m \\left( \\sum_{k=m}^{n}  \\binom{n-m}{k-m} p^{k-m} (1-p)^{n-k} (1-q)^{k-m} \\right) \\\\[2pt]\n&\\binom{n}{m} (pq)^m \\left( \\sum_{k\nm}^{n}  \\binom{n-m}{k-m} \\left(p(1-q)\\right)^{k-m} (1-p)^{n-k}  \\right)\n\\end{align}\n\nAfter substituting  i = k - m  in the expression above, we get\n \\Pr[Y m] \n \\binom{n}{m} (pq)^m \\left( \\sum_{i=0}^{n-m} \\binom{n-m}{i} (p - pq)^i (1-p)^{n-m - i} \\right) \nNotice that the sum (in the parentheses) above equals  (p - pq + 1 - p)^{n-m}  by the binomial theorem. Substituting this in finally yields\n\n\\begin{align}\n\\Pr[Ym] &\n  \\binom{n}{m} (pq)^m (p - pq + 1 - p)^{n-m}\\\\[4pt]\n&= \\binom{n}{m} (pq)^m (1-pq)^{n-m}\n\\end{align}\n\nand thus  Y \\sim B(n, pq)  as desired.\n\nBernoulli distribution\n\nThe Bernoulli distribution is a special case of the binomial distribution, where n = 1. Symbolically, X ~ B(1, p) has the same meaning as X ~ B(p). Conversely, any binomial distribution, B(n, p), is the distribution of the sum of n Bernoulli trials, B(p), each with the same probability p.\n\nPoisson binomial distribution\n\nThe binomial distribution is a special case of the Poisson binomial distribution, or general binomial distribution, which is the distribution of a sum of n independent non-identical Bernoulli trials B(pi).\n\nNormal approximation\n\nIf n is large enough, then the skew of the distribution is not too great. In this case a reasonable approximation to B(n, p) is given by the normal distribution\n\n \\mathcal{N}(np,\\,np(1-p)),\n\nand this basic approximation can be improved in a simple way by using a suitable continuity correction.\nThe basic approximation generally improves as n increases (at least 20) and is better when p is not near to 0 or 1. Various rules of thumb may be used to decide whether n is large enough, and p is far enough from the extremes of zero or one:\n\n*One rule is that for  the normal approximation is adequate if the absolute value of the skewness is strictly less than 1/3; that is, if\n:\\frac{\\sqrt{np(1-p)}}=\\frac1{\\sqrt{n}}\\left|\\sqrt{\\frac{1-p}p}-\\sqrt{\\frac{p}{1-p}}\\,\\right|\n\n*A stronger rule states that the normal approximation is appropriate only if everything within 3 standard deviations of its mean is within the range of possible values; that is, only if\n:\\mu\\pm3\\sigma=np\\pm3\\sqrt{np(1-p)}\\in(0,n).\nThis 3-standard-deviation rule is equivalent to the following conditions, which also imply the first rule above.\n:n>9\\,\\frac{1-p}p\\quad\\hbox{and}\\quad n>9\\,\\frac{p}{1-p}.\n\nThe rule  np\\pm3\\sqrt{np(1-p)}\\in(0,n) is totally equivalent to request that\nnp-3\\sqrt{np(1-p)}>0\\quad\\hbox{and}\\quad np+3\\sqrt{np(1-p)}\nMoving terms around yields:\nnp>3\\sqrt{np(1-p)}\\quad\\hbox{and}\\quad n(1-p)>3\\sqrt{np(1-p)}.\nSince 0, we can apply the square power and divide by the respective factors np^2 and n(1-p)^2, to obtain the desired conditions:\nn>9\\,\\frac{1-p}p\\quad\\hbox{and}\\quad n>9\\,\\frac{p}{1-p}.\nNotice that these conditions automatically imply that n>9. On the other hand, apply again the square root and divide by 3,\n\\frac{\\sqrt{n}}3>\\sqrt{\\frac{1-p}p}>0\\quad\\hbox{and}\\quad\\frac{\\sqrt{n}}3>\\sqrt{\\frac{p}{1-p}}>0.\nSubtracting the second set of inequalities from the first one yields:\n\\frac{\\sqrt{n}}3>\\sqrt{\\frac{1-p}p}-\\sqrt{\\frac{p}{1-p}}>-\\frac{\\sqrt{n}}3;\nand so, the desired first rule is satisfied,\n\\left|\\sqrt{\\frac{1-p}p}-\\sqrt{\\frac{p}{1-p}}\\,\\right|\n\n*Another commonly used rule is that both values np and n(1-p) must be greater than or equal to 5. However, the specific number varies from source to source, and depends on how good an approximation one wants. In particular, if one uses 9 instead of 5, the rule implies the results stated in the previous paragraphs.\n\nAssume that both values np and n(1-p) are greater than 9. Since 0, we easily have that \nnp\\geq9>9(1-p)\\quad\\hbox{and}\\quad n(1-p)\\geq9>9p.\nWe only have to divide now by the respective factors p and 1-p, to deduce the alternative form of the 3-standard-deviation rule:\nn>9\\,\\frac{1-p}p\\quad\\hbox{and}\\quad n>9\\,\\frac{p}{1-p}.\n\nThe following is an example of applying a continuity correction. Suppose one wishes to calculate Pr(X ≤ 8) for a binomial random variable X. If Y has a distribution given by the normal approximation, then Pr(X ≤ 8) is approximated by Pr(Y ≤ 8.5). The addition of 0.5 is the continuity correction; the uncorrected normal approximation gives considerably less accurate results.\n\nThis approximation, known as de Moivre–Laplace theorem, is a huge time-saver when undertaking calculations by hand (exact calculations with large n are very onerous); historically, it was the first use of the normal distribution, introduced in Abraham de Moivre's book The Doctrine of Chances in 1738. Nowadays, it can be seen as a consequence of the central limit theorem since B(n, p) is a sum of n independent, identically distributed Bernoulli variables with parameter p. This fact is the basis of a hypothesis test, a \"proportion z-test\", for the value of p using x/n, the sample proportion and estimator of p, in a common test statistic.NIST/SEMATECH, [http://www.itl.nist.gov/div898/handbook/prc/section2/prc24.htm \"7.2.4. Does the proportion of defectives meet requirements?\"] e-Handbook of Statistical Methods.\n\nFor example, suppose one randomly samples n people out of a large population and ask them whether they agree with a certain statement. The proportion of people who agree will of course depend on the sample. If groups of n people were sampled repeatedly and truly randomly, the proportions would follow an approximate normal distribution with mean equal to the true proportion p of agreement in the population and with standard deviation \\sigma = \\sqrt{\\frac{p(1-p)}{n}}\n\nPoisson approximation\n\nThe binomial distribution converges towards the Poisson distribution as the number of trials goes to infinity while the product np remains fixed or at least p tends to zero. Therefore, the Poisson distribution with parameter λ np can be used as an approximation to B(n, p) of the binomial distribution if n is sufficiently large and p is sufficiently small.  According to two rules of thumb, this approximation is good if n ≥ 20 and p ≤ 0.05, or if n ≥ 100 and np ≤ 10.NIST/SEMATECH, [http://www.itl.nist.gov/div898/handbook/pmc/section3/pmc331.htm \"6.3.3.1. Counts Control Charts\"], e-Handbook of Statistical Methods.\n\nConcerning the accuracy of Poisson approximation, see Novak,Novak S.Y. (2011) Extreme value methods with applications to finance. London: CRC/ Chapman & Hall/Taylor & Francis. . ch. 4, and references therein.\n\nLimiting distributions\n\n* Poisson limit theorem: As n approaches ∞ and p approaches 0, then the Binomial(n, p) distribution approaches the Poisson distribution with expected value λ np.\n* de Moivre–Laplace theorem: As n approaches ∞ while p remains fixed, the distribution of\n\n:\\frac{X-np}{\\sqrt{np(1-p)}}\n\napproaches the normal distribution with expected value 0 and variance 1.  This result is sometimes loosely stated by saying that the distribution of X is asymptotically normal with expected value np and variance np(1 − p). This result is a specific case of the central limit theorem.\n\nBeta distribution\n\nBeta distributions  provide a family of prior probability distributions for binomial distributions in Bayesian inference:\nP(p;\\alpha,\\beta) = \\frac{p^{\\alpha-1}(1-p)^{\\beta-1}}{\\mathrm{B}(\\alpha,\\beta)}.\n\nConfidence intervals\n\nEven for quite large values of n, the actual distribution of the mean is significantly nonnormal. Because of this problem several methods to estimate confidence intervals have been proposed.\n\nIn the equations for confidence intervals below, the variables have the following meaning:\n\n* n1 is the number of successes out of n, the total number of trials\n*  \\hat{p} = \\frac{n_1}{n} is the proportion of successes\n* z is the 1 - \\tfrac{1}{2}\\alpha quantile of a standard normal distribution (i.e., probit) corresponding to the target error rate \\alpha. For example, for a 95% confidence level the error \\alpha  0.05, so 1 - \\tfrac{1}{2}\\alpha \n 0.975 and z = 1.96.\n\nWald method \n\n:  \\hat{p} \\pm z \\sqrt{ \\frac{ \\hat{p} ( 1 -\\hat{p} )}{ n } } .\n\nA continuity correction of 0.5/n may be added.\n\nAgresti-Coull method \n\n:  \\tilde{p} \\pm z \\sqrt{ \\frac{ \\tilde{p} ( 1 - \\tilde{p} )}{ n + z^2 } } .\n\nHere the estimate of p is modified to\n\n:  \\tilde{p}= \\frac{ n_1 + \\frac{1}{2} z^2}{ n + z^2 } \n\nArcSine methodPires MA [http://www.math.ist.utl.pt/~apires/PDFs/AP_COMPSTAT02.pdf Confidence intervals for a binomial proportion: comparison of methods and software evaluation.] \n\n:\\sin^2 \\left (\\arcsin \\left ( \\sqrt{ \\hat{p} } \\right ) \\pm \\frac{ z }{ 2 \\sqrt{ n } } \\right ) \n\nWilson (score) method\n\nThe notation in the formula below differs from the previous formula's in two respects:\n\n* Firstly, zx has a slightly different interpretation in the formula below: it has its ordinary meaning of 'the xth quantile of the standard normal distribution', rather than being a shorthand for 'the (1 - x)-th quantile'.\n\n* Secondly, this formula does not use a plus-minus to define the two bounds. Instead, one may use z z_{\\alpha / 2} to get the lower bound, or use z \n z_{1 - \\alpha/2} to get the upper bound. For example: for a 95% confidence level the error \\alpha  0.05, so one gets the lower bound by using z \n z_{\\alpha/2} z_{0.025} \n - 1.96, and one gets the upper bound by using z z_{1 - \\alpha/2} \n z_{0.975} = 1.96.\n\n\\frac{\n    \\hat{p} + \\frac{z^2}{2n} + z\n    \\sqrt{\n        \\frac{\\hat{p}(1 - \\hat{p})}{n} +\n        \\frac{z^2}{4 n^2}\n    }\n}{\n    1 + \\frac{z^2}{n}\n}\n\nComparison \n\nThe exact (Clopper-Pearson) method is the most conservative. \n\nThe Wald method, although commonly recommended in textbooks, is the most biased.\n\nGenerating binomial random variates\n\nMethods for random number generation where the marginal distribution is a binomial distribution are well-established.Devroye, Luc (1986) Non-Uniform Random Variate Generation, New York: Springer-Verlag. (See especially [http://luc.devroye.org/chapter_ten.pdf Chapter X, Discrete Univariate Distributions])\n\nOne way to generate random samples from a binomial distribution is to use an inversion algorithm. To do so, one must calculate the probability that P(X=k) for all values k from 0 through n. (These probabilities should sum to a value close to one, in order to encompass the entire sample space.) Then by using a pseudorandom number generator to generate samples uniformly between 0 and 1, one can transform the calculated samples U[0,1] into discrete numbers by using the probabilities calculated in step one.\n\nTail bounds\n\nFor k ≤ np, upper bounds for the lower tail of the distribution function can be derived.  Recall that F(k;n,p) = \\Pr(X \\le k), the probability that there are at most k successes.\n\nHoeffding's inequality yields the bound\n\n F(k;n,p) \\leq \\exp\\left(-2 \\frac{(np-k)^2}{n}\\right), \\!\n\nand Chernoff's inequality can be used to derive the bound\n\n F(k;n,p) \\leq \\exp\\left(-\\frac{1}{2\\,p} \\frac{(np-k)^2}{n}\\right). \\!\n\nMoreover, these bounds are reasonably tight when p = 1/2, since the following expression holds for all k ≥ 3n/8Matoušek, J, Vondrak, J: The Probabilistic Method (lecture notes) [https://www.cs.cmu.edu/afs/cs.cmu.edu/academic/class/15859-f09/www/handouts/matousek-vondrak-prob-ln.pdf].\n\n F(k;n,\\tfrac{1}{2}) \\leq \\frac{14}{15} \\exp\\left(- \\frac{16 (\\frac{n}{2} - k)^2}{n}\\right). \\!\n\nHowever, the bounds do not work well for extreme values of p. In particular, as p \\rightarrow 1, value F(k;n,p) goes to zero (for fixed k, n with kR. Arratia and L. Gordon: Tutorial on large deviations for the binomial distribution, Bulletin of Mathematical Biology 51(1) (1989), 125–131 [https://link.springer.com/article/10.1007%2FBF02458840].\n\n F(k;n,p) \\leq \\exp\\left(-nD\\left(\\frac{k}{n}\\left|\\right|p\\right)\\right) \\quad\\quad\\mbox{if }0\n\nwhere D(a || p) is the relative entropy between an a-coin and a p-coin (i.e. between the Bernoulli(a) and Bernoulli(p) distribution):\n\n D(a||p)=(a)\\log\\frac{a}{p}+(1-a)\\log\\frac{1-a}{1-p}. \\!\n\nAsymptotically, this bound is reasonably tight; see\n for details. An equivalent formulation of the bound is\n\n \\Pr(X \\ge k) =F(n-k;n,1-p)\\leq \\exp\\left(-nD\\left(\\frac{k}{n}\\left|\\right|p\\right)\\right) \\quad\\quad\\mbox{if }p\nBoth these bounds are derived directly from the Chernoff bound.\nIt can also be shown that,\n\n \\Pr(X \\ge k) =F(n-k;n,1-p)\\geq \\frac{1}{(n+1)^2} \\exp\\left(-nD\\left(\\frac{k}{n}\\left|\\right|p\\right)\\right) \\quad\\quad\\mbox{if }p\n\nThis is proved using the method of types (see for example chapter 12 of Elements of Information Theory by Cover and Thomas Theorem 11.1.3 in ).\n\nWe can also change the (n+1)^2 in the denominator to \\sqrt{2n}, by approximating the binomial coefficient with Stirling's formula.\n\nHistory\n\nThis distribution was derived by James Bernoulli in 1713. He considered the case where p r/(r+s) where p is the probability of success and r and s are positive integers. Blaise Pascal had earlier considered the case where p \n 1/2. Binomial distribution. http://en.wikipedia.org/?curid=3876."
  }
}
