{
  "datasourceIdentifier" : "awesome wiki export",
  "backlink" : "http://en.wikipedia.org/?curid=634",
  "eid" : "87b84690-52b1-11e8-ad1f-273b2f3b71fa",
  "loadTime" : 1525778307449,
  "textBody" : "Analysis of variance (ANOVA) is a collection of statistical models and their associated procedures (such as \"variation\" among and between groups) used to analyze the differences among group means. ANOVA was developed by statistician and evolutionary biologist Ronald Fisher. In the ANOVA setting, the observed variance in a particular variable is partitioned into components attributable to different sources of variation. In its simplest form, ANOVA provides a statistical test of whether or not the means of several groups are equal, and therefore generalizes the t-test to more than two groups.   ANOVAs are useful for comparing (testing) three or more means (groups or variables) for statistical significance.  It is conceptually similar to multiple two-sample t-tests, but is more conservative (results in less type I error)  and is therefore suited to a wide range of practical problems.\n\nHistory\n\nWhile the analysis of variance reached fruition in the 20th century, antecedents extend centuries into the past according to Stigler.Stigler (1986)  These include hypothesis testing, the partitioning of sums of squares, experimental techniques and the additive model. Laplace was performing hypothesis testing in the 1770s.Stigler (1986, p 134) The development of least-squares methods by Laplace and Gauss circa 1800 provided an improved method of combining observations (over the existing practices then used in astronomy and geodesy). It also initiated much study of the contributions to sums of squares. Laplace soon knew how to estimate a variance from a residual (rather than a total) sum of squares.Stigler (1986, p 153) By 1827 Laplace was using least squares methods to address ANOVA problems regarding measurements of atmospheric tides.Stigler (1986, pp 154–155) Before 1800 astronomers had isolated observational errors resulting \nfrom reaction times (the \"personal equation\") and had developed methods of reducing the errors.Stigler (1986, pp 240–242)  The experimental methods used in the study of the personal equation were later accepted by the emerging field of psychology Stigler (1986, \nChapter 7 - Psychophysics as a Counterpoint) which developed strong (full factorial) experimental methods to which randomization and blinding were soon added.Stigler (1986, p 253)  An eloquent non-mathematical explanation of the additive effects model was\navailable in 1885.Stigler (1986, pp 314–315)\n\nRonald Fisher introduced the term variance and proposed its formal analysis in a 1918 article The Correlation Between Relatives on the Supposition of Mendelian Inheritance.The Correlation Between Relatives on the Supposition of Mendelian Inheritance. Ronald A. Fisher. Philosophical Transactions of the Royal Society of Edinburgh. 1918. (volume 52, pages 399–433)  His first application of the analysis of variance was published in 1921.On the \"Probable Error\" of a Coefficient of Correlation Deduced from a Small Sample. Ronald A. Fisher. Metron, 1: 3-32 (1921) Analysis of variance became widely known after being included in Fisher's 1925 book Statistical Methods for Research Workers.\n\nRandomization models were developed by several researchers.  The first was published in Polish by Jerzy Neyman in 1923.Scheffé (1959, p 291, \"Randomization models were first formulated by Neyman (1923) for the completely randomized design, by Neyman (1935) for randomized blocks, by Welch (1937) and Pitman (1937) for the Latin square under a certain null hypothesis, and by Kempthorne (1952, 1955) and Wilk (1955) for many other designs.\")\n\nOne of the attributes of ANOVA which ensured its early popularity was computational elegance.  The structure of the additive model allows solution for the additive coefficients by simple algebra rather than by matrix calculations.  In the era of mechanical calculators this simplicity was critical.  The determination of statistical significance also required access to tables of the F function which were supplied by early statistics texts.\n\nMotivating example\n\nThe analysis of variance can be used as an exploratory tool to explain observations.  A dog show provides an example.  A dog show is not a random sampling of the breed: it is typically limited to dogs that are adult, pure-bred, and exemplary.  A histogram of dog weights from a show might plausibly be rather complex, like the yellow-orange distribution shown in the illustrations.  Suppose we wanted to predict the weight of a dog based on a certain set of characteristics of each dog. One way to do that is to explain the distribution of weights by dividing the dog population into groups based on those characteristics. A successful grouping will split dogs such that (a) each group has a low variance of dog weights (meaning the group is relatively homogeneous) and (b) the mean of each group is distinct (if two groups have the same mean, then it isn't reasonable to conclude that the groups are, in fact, separate in any meaningful way).\nIn the illustrations to the right, groups are identified as X1, X2, etc. In the first illustration, the dogs are divided according to the product (interaction) of two binary groupings: young vs old, and short-haired vs long-haired (e.g., group 1 is young, short-haired dogs, group 2 is young, long-haired dogs, etc.). Since the distributions of dog weight within each of the groups (shown in blue) has a relatively large variance, and since the means are very similar across groups, grouping dogs by these characteristics does not produce an effective way to explain the variation in dog weights: knowing which group a dog is in doesn't allow us to predict its weight much better than simply knowing the dog is in a dog show. Thus, this grouping fails to explain the variation in the overall distribution (yellow-orange).\n\nAn attempt to explain the weight distribution by grouping dogs as pet vs working breed and less athletic vs more athletic would probably be somewhat more successful (fair fit).  The heaviest show dogs are likely to be big strong working breeds, while breeds kept as pets tend to be smaller and thus lighter.  As shown by the second illustration, the distributions have variances that are considerably smaller than in the first case, and the means are more distinguishable. However, the significant overlap of distributions, for example, means that we cannot distinguish X1 and X2 reliably. Grouping dogs according to a coin flip might produce distributions that look similar.\n\nAn attempt to explain weight by breed is likely to produce a very good fit.  All Chihuahuas are light and all St Bernards are heavy.  The difference in weights between Setters and Pointers does not justify separate breeds.  The analysis of variance provides the formal tools to justify these intuitive judgments.  A common use of the method is the analysis of experimental data or the development of models.  The method has some advantages over correlation: not all of the data must be numeric and one result of the method is a judgment in the confidence in an explanatory relationship.\n\nBackground and terminology\n\nANOVA is a particular form of statistical hypothesis testing heavily used in the analysis of experimental data.  A test  result (calculated from the null hypothesis and the sample) is called statistically significant if it is deemed unlikely to have occurred by chance, assuming the truth of the null hypothesis. A statistically significant result, when a probability (p-value) is less than a threshold (significance level), justifies the rejection of the null hypothesis, but only if the a priori probability of the null hypothesis is not high.\n\nIn the typical application of ANOVA, the null hypothesis is that all groups are simply random samples of the same population. For example, when studying the effect of different treatments on similar samples of patients, the null hypothesis would be that all treatments have the same effect (perhaps none). Rejecting the null hypothesis is taken to mean that the differences in observed effects between treatment groups is unlikely to be due to random chance.\n\nBy construction, hypothesis testing limits the rate of Type I errors (false positives) to a significance level.  Experimenters also wish to limit Type II errors (false negatives).  \nThe rate of Type II errors depends largely on sample size (the rate will increase for small numbers of samples), significance \nlevel (when the standard of proof is high, the chances of overlooking \na discovery are also high) and effect size (a smaller effect size is more prone to Type II error).\n\nThe terminology of ANOVA is largely from the statistical \ndesign of experiments.  The experimenter adjusts factors and \nmeasures responses in an attempt to determine an effect.  Factors are \nassigned to experimental units by a combination of randomization and \nblocking to ensure the validity of the results.  Blinding keeps the\nweighing impartial.  Responses show a variability that is partially \nthe result of the effect and is partially random error.\n\nANOVA is the synthesis of several ideas and it is used for multiple \npurposes.  As a consequence, it is difficult to define concisely or precisely.\n\n\"Classical\" ANOVA for balanced data does three things at once:\n\nIn short, ANOVA is a statistical tool used in several ways to develop and confirm an explanation for the observed data.\n\nAdditionally:\n\nAs a result:\nANOVA \"has long enjoyed the status of being the most used (some would \nsay abused) statistical technique in psychological research.\"\nHowell (2002, p 320)\nANOVA \"is probably the most useful technique in the field of \nstatistical inference.\"Montgomery (2001, p 63)\n\nANOVA is difficult to teach, particularly for complex experiments, with split-plot designs being notorious.Gelman (2005, p 1)  In some cases the proper \napplication of the method is best determined by problem pattern recognition \nfollowed by the consultation of a classic authoritative test.\nGelman (2005, p 5)\n\nDesign-of-experiments terms\n\n(Condensed from the NIST Engineering Statistics handbook: Section 5.7. A \nGlossary of DOE Terminology.)\n\n; Balanced design: An experimental design where all cells (i.e. treatment combinations) have the same number of observations.\n; Blocking: A schedule for conducting treatment combinations in an experimental study such that any effects on the experimental results due to a known change in raw materials, operators, machines, etc., become concentrated in the levels of the blocking variable. The reason for blocking is to isolate a systematic effect and prevent it from obscuring the main effects. Blocking is achieved by restricting randomization.\n; Design: A set of experimental runs which allows the fit of a particular model and the estimate of effects.\n; DOE: Design of experiments.  An approach to problem solving involving collection of data that will support valid, defensible, and supportable conclusions.\n; Effect: How changing the settings of a factor changes the response. The effect of a single factor is also called a main effect.\n; Error: Unexplained variation in a collection of observations. DOE's typically require understanding of both random error and lack of fit error.\n; Experimental unit: The entity to which a specific treatment combination is applied.\n; Factors: Process inputs that an investigator manipulates to cause a change in the output.\n; Lack-of-fit error: Error that occurs when the analysis omits one or more important terms or factors from the process model. Including replication in a DOE allows separation of experimental error into its components: lack of fit and random (pure) error.\n; Model: Mathematical relationship which relates changes in a given response to changes in one or more factors.\n; Random error: Error that occurs due to natural variation in the process. Random error is typically assumed to be normally distributed with zero mean and a constant variance. Random error is also called experimental error.\n; Randomization: A schedule for allocating treatment material and for conducting treatment combinations in a DOE such that the conditions in one run neither depend on the conditions of the previous run nor predict the conditions in the subsequent runs.Randomization is a term used in multiple ways in this\nmaterial.  \"Randomization has three roles in applications: as a device \nfor eliminating biases, for example from unobserved explanatory \nvariables and selection effects: as a basis for estimating standard \nerrors: and as a foundation for formally exact significance tests.\"  \nCox (2006, page 192)  Hinkelmann and Kempthorne use randomization \nboth in experimental design and for statistical analysis.\n; Replication: Performing the same treatment combination more than once. Including replication allows an estimate of the random error independent of any lack of fit error.\n; Responses: The output(s) of a process. Sometimes called dependent variable(s).\n; Treatment: A treatment is a specific combination of factor levels whose effect is to be compared with other treatments.\n\nClasses of models \n\nThere are three classes of models used in the analysis of variance, and these are outlined here.\n\nFixed-effects models\n\nThe fixed-effects model (class I) of analysis of variance applies to situations in which the experimenter applies one or more treatments to the subjects of the experiment to see whether the response variable values change. This allows the experimenter to estimate the ranges of response variable values that the treatment would generate in the population as a whole.\n\nRandom-effects models\n\nRandom effects model (class II) is used when the treatments are not fixed. This occurs when the various factor levels are sampled from a larger population. Because the levels themselves are random variables, some assumptions and the method of contrasting the treatments (a multi-variable generalization of simple differences) differ from the fixed-effects model.Montgomery (2001, Chapter 12: Experiments with random factors)\n\nMixed-effects models\n\nA mixed-effects model (class III) contains experimental factors of both fixed and random-effects types, with appropriately different interpretations and analysis for the two types.\n\nExample:\nTeaching experiments could be performed by a college or university department \nto find a good introductory textbook, with each text considered a \ntreatment.  The fixed-effects model would compare a list of candidate \ntexts.  The random-effects model would determine whether important \ndifferences exist among a list of randomly selected texts.  The \nmixed-effects model would compare the (fixed) incumbent texts to \nrandomly selected alternatives.\n\nDefining fixed and random effects has proven elusive, with competing \ndefinitions arguably leading toward a linguistic quagmire.\nGelman (2005, pp. 20–21)\n\nAssumptions\n\nThe analysis of variance has been studied from several approaches, the most common of which uses a linear model that relates the response to the treatments and blocks. Note that the model is linear in parameters but may be nonlinear across factor levels. Interpretation is easy when data is balanced across factors but much deeper understanding is needed for unbalanced data.\n\nTextbook analysis using a normal distribution\n\nThe analysis of variance can be presented in terms of a linear model, which makes the following assumptions about the probability distribution of the responses:Cochran & Cox (1992, p 48)Howell (2002, p 323)\n\n* Independence of observations – this is an assumption of the model that simplifies the statistical analysis.\n* Normality – the distributions of the residuals are normal.\n* Equality (or \"homogeneity\") of variances, called homoscedasticity — the variance of data in groups should be the same.\n\nThe separate assumptions of the textbook model imply that the errors are independently, identically, and normally distributed for fixed effects models, that is, that the errors (\\varepsilon) are independent and\n\n\\varepsilon \\thicksim N(0, \\sigma^2).\\,\n\nRandomization-based analysis\n\nIn a randomized controlled experiment, the treatments are randomly assigned to experimental units, following the experimental protocol. This randomization is objective and declared before the experiment is carried out. The objective random-assignment is used to test the significance of the null hypothesis, following the ideas of C. S. Peirce and Ronald Fisher. This design-based analysis was discussed and developed by Francis J. Anscombe at Rothamsted Experimental Station and by Oscar Kempthorne at Iowa State University.Anscombe (1948) Kempthorne and his students make an assumption of unit treatment additivity, which is discussed in the books of Kempthorne and David R. Cox.\n\nUnit-treatment additivity\n\nIn its simplest form, the assumption of unit-treatment additivityUnit-treatment additivity is simply termed additivity\nin most texts.  Hinkelmann and Kempthorne add adjectives and\ndistinguish between additivity in the strict and broad senses.  This \nallows a detailed consideration of multiple error sources (treatment, \nstate, selection, measurement and sampling) on page 161. states that the observed response y_{i,j} from experimental unit i when receiving treatment j can be written as the sum of the unit's response y_i and the treatment-effect  t_j, that is Kempthorne (1979, p 30)Cox (1958, Chapter 2: Some Key Assumptions)Hinkelmann and Kempthorne (2008, Volume 1, Throughout.  Introduced in Section 2.3.3: Principles of experimental design; The linear model; Outline of a model)\ny_{i,j}=y_i+t_j.\nThe assumption of unit-treatment additivity implies that, for every treatment j, the jth treatment has  exactly the same effect t_j on every experiment unit.\n\nThe assumption of unit treatment additivity  usually cannot be directly falsified, according to Cox and Kempthorne. However, many consequences of treatment-unit additivity can be falsified. For a randomized experiment, the assumption of unit-treatment additivity implies that the variance is constant for all treatments. Therefore, by contraposition, a necessary condition for unit-treatment additivity is that the variance is constant.\n\nThe use of unit treatment additivity and randomization is similar to the design-based inference that is standard in finite-population survey sampling.\n\nDerived linear model\n\nKempthorne uses the randomization-distribution and the assumption of unit treatment additivity to produce a derived linear model, very similar to the textbook model discussed previously.Hinkelmann and Kempthorne (2008, Volume 1, Section 6.3: \nCompletely Randomized Design; Derived Linear Model)  The test statistics of this derived linear model are closely approximated by the test statistics of an appropriate normal linear model, according to approximation theorems and simulation studies.Hinkelmann and Kempthorne (2008, Volume 1, Section 6.6: Completely randomized design; Approximating the randomization test) However, there are differences. For example, the randomization-based analysis results in a small but (strictly) negative correlation between the observations.Bailey (2008, Chapter 2.14 \"A More General Model\" in Bailey, pp. 38–40)Hinkelmann and Kempthorne (2008, Volume 1, Chapter 7: Comparison of Treatments) In the randomization-based analysis, there is no assumption of a normal distribution and certainly no assumption of independence. On the contrary, the observations are dependent!\n\nThe randomization-based analysis has the disadvantage that its exposition involves tedious algebra and extensive time.  Since the randomization-based analysis is complicated and is closely approximated by the approach using a normal linear model, most teachers emphasize the normal linear model approach. Few statisticians object to model-based analysis of balanced randomized experiments.\n\nStatistical models for observational data\n\nHowever, when applied to data from non-randomized experiments or observational studies, model-based analysis lacks the warrant of randomization.\nKempthorne (1979, pp 125–126, \n\"The experimenter must decide which of the various causes that he \nfeels will produce variations in his results must be controlled \nexperimentally.  Those causes that he does not control experimentally, \nbecause he is not cognizant of them, he must control by the device of \nrandomization.\"  \"[O]nly when the treatments in the experiment are \napplied by the experimenter using the full randomization procedure is \nthe chain of inductive inference sound.  It is only under these \ncircumstances that the experimenter can attribute whatever effects he \nobserves to the treatment and the treatment only.  Under these \ncircumstances his conclusions are reliable in the statistical sense.\")  \n For observational data, the derivation of confidence intervals must use subjective models, as emphasized by Ronald Fisher and his followers. In practice, the estimates of treatment-effects from observational studies  generally are often inconsistent.  In practice, \"statistical models\" and observational data are useful for suggesting hypotheses that should be treated very cautiously by the public.Freedman \n\nSummary of assumptions\n\nThe normal-model based ANOVA analysis assumes the independence, normality and \nhomogeneity of the variances of the residuals. The \nrandomization-based analysis assumes only the homogeneity of the \nvariances of the residuals (as a consequence of unit-treatment \nadditivity) and uses the randomization procedure of the experiment. \nBoth these analyses require homoscedasticity, as an assumption for the normal-model analysis and as a consequence of randomization and additivity for the randomization-based analysis.\n\nHowever, studies of processes that \nchange variances rather than means (called dispersion effects) have \nbeen successfully conducted using ANOVA.Montgomery \n(2001, Section 3.8: Discovering dispersion effects)  There are\nno necessary assumptions for ANOVA in its full generality, but the\nF-test used for ANOVA hypothesis testing has assumptions and practical \nlimitations which are of continuing interest.\n\nProblems which do not satisfy the assumptions of ANOVA can often be transformed to satisfy the assumptions. \nThe property of unit-treatment additivity is not invariant under a \"change of scale\", so statisticians often use transformations to achieve unit-treatment additivity. If the response variable is expected to follow a parametric family of probability distributions, then the statistician may specify (in the protocol for the experiment or observational study) that the responses be transformed to stabilize the variance.Hinkelmann and Kempthorne (2008, Volume 1, Section 6.10: Completely randomized design; Transformations) Also, a statistician may specify that logarithmic transforms be applied to the responses, which are believed to follow a multiplicative model.Bailey (2008)\nAccording to Cauchy's functional equation theorem, the logarithm is the only continuous transformation that transforms real multiplication to addition.\n\nCharacteristics\n\nANOVA is used in the analysis of comparative experiments, those in \nwhich only the difference in outcomes is of interest.  The statistical\nsignificance of the experiment is determined by a ratio of two \nvariances.  This ratio is independent of several possible alterations\nto the experimental observations: Adding a constant to all \nobservations does not alter significance.  Multiplying all \nobservations by a constant does not alter significance.  So ANOVA \nstatistical significance result is independent of constant bias and \nscaling errors as well as the units used in expressing observations.  \nIn the era of mechanical calculation it was common to \nsubtract a constant from all observations (when equivalent to \ndropping leading digits) to simplify data entry.Montgomery \n(2001, Section 3-3: Experiments with a single factor: The analysis of \nvariance; Analysis of the fixed effects model)\nCochran & Cox (1992, p 2 example)  This is an example of data\ncoding.\n\nLogic\n\nThe calculations of ANOVA can be characterized as computing a number\nof means and variances, dividing two variances and comparing the ratio \nto a handbook value to determine statistical significance.  Calculating \na treatment effect is then trivial, \"the effect of any treatment is \nestimated by taking the difference between the mean of the \nobservations which receive the treatment and the general mean\".\nCochran & Cox (1992, p 49)\n\nPartitioning of the sum of squares\n\nANOVA uses traditional standardized terminology.  The definitional \nequation of sample variance is\ns^2=\\textstyle\\frac{1}{n-1}\\sum(y_i-\\bar{y})^2, where the \ndivisor is called the degrees of freedom (DF), the summation is called \nthe sum of squares (SS), the result is called the mean square (MS) and \nthe squared terms are deviations from the sample mean.  ANOVA \nestimates 3 sample variances: a total variance based on all the \nobservation deviations from the grand mean, an error variance based on \nall the observation deviations from their appropriate \ntreatment means, and a treatment variance.  The treatment variance is\nbased on the deviations of treatment means from the grand mean, the \nresult being multiplied by the number of observations in each \ntreatment to account for the difference between the variance of \nobservations and the variance of means.\n\nThe fundamental technique is a partitioning of the total sum of squares SS into components related to the effects used in the model. For example, the model for a simplified ANOVA with one type of treatment at different levels.\n\nSS_\\text{Total} = SS_\\text{Error} + SS_\\text{Treatments}\n\nThe number of degrees of freedom DF can be partitioned in a similar way: one of these components (that for error) specifies a chi-squared distribution which describes the associated sum of squares, while the same is true for \"treatments\" if there is no treatment effect.\n\nDF_\\text{Total} = DF_\\text{Error} + DF_\\text{Treatments}\n\nSee also Lack-of-fit sum of squares.\n\nThe F-test\n\nThe F-test is used for comparing the factors of the total deviation. For example, in one-way, or single-factor ANOVA, statistical significance is tested for by comparing the F test statistic\n\nF = \\frac{\\text{variance between treatments}}{\\text{variance within treatments}}\n\nF \\frac{MS_\\text{Treatments}}{MS_\\text{Error}} \n \nwhere  MS is mean square, I  = number of treatments and \nn_T = total number of cases\n\nto the F-distribution with I - 1, n_T - I  degrees of freedom. Using the F-distribution is a natural candidate because the test statistic is the ratio of two scaled sums of squares each of which follows a scaled chi-squared distribution.\n\nThe expected value of F is 1 + {n \\sigma^2_\\text{Treatment}} / \n{\\sigma^2_\\text{Error}} (where n is the treatment sample size)\nwhich is 1 for no treatment effect.  As values of F increase above 1, the evidence is increasingly inconsistent with the null hypothesis. Two apparent experimental methods of increasing F are increasing the sample size and reducing the error variance by tight experimental controls.\n\nThere are two methods of concluding the ANOVA hypothesis test, both of which produce the same result:\n* The textbook method is to compare the observed value of F with the critical value of F determined from tables. The critical value of F is a function of the degrees of freedom of the numerator and the denominator and the significance level (α).  If F ≥ FCritical, the null hypothesis is rejected.\n* The computer method calculates the probability (p-value) of a value of F greater than or equal to the observed value.  The null hypothesis is rejected if this probability is less than or equal to the significance level (α).\nThe ANOVA F-test is known to be nearly optimal in the sense of minimizing false negative errors for a fixed rate of false positive errors (i.e. maximizing power for a fixed significance level). For example, to test the hypothesis that various medical treatments have exactly the same effect, the F-test's p-values closely approximate the permutation test's p-values: The approximation is particularly close when the design is balanced.Hinkelmann and Kempthorne (2008, Volume 1, Section 6.7: Completely randomized design; CRD with unequal numbers of replications) Such permutation tests characterize tests with maximum power against all alternative hypotheses, as observed by Rosenbaum.Rosenbaum (2002, page 40) cites Section 5.7 (Permutation Tests), Theorem 2.3 (actually Theorem 3, page 184) of Lehmann's Testing Statistical Hypotheses (1959). The ANOVA F–test (of the null-hypothesis that all treatments have exactly the same effect) is recommended as a practical test, because of its robustness against many alternative distributions.Moore and McCabe (2003, page 763)The F-test for the comparison of variances has a mixed reputation.  It \nis not recommended as a hypothesis test to determine whether two \ndifferent samples have the same variance.  It is recommended for \nANOVA where two estimates of the variance of the same \nsample are compared.  While the F-test is not generally robust against \ndepartures from normality, it has been found to be robust in the \nspecial case of ANOVA.  Citations from Moore & McCabe (2003): \n\"Analysis of variance uses F statistics, but these are not \nthe same as the F statistic for comparing two population standard \ndeviations.\" (page 554) \"The F test and other procedures for inference \nabout variances are so lacking in robustness as to be of little use in \npractice.\" (page 556)  \"[The ANOVA F test] is relatively insensitive \nto moderate nonnormality and unequal variances, especially when the \nsample sizes are similar.\" (page 763)  ANOVA assumes homoscedasticity, \nbut it is robust.  The statistical test for homoscedasticity (the \nF-test) is not robust.  Moore & McCabe recommend a rule of thumb.\n\nExtended logic\n\nANOVA consists of separable parts; partitioning sources of variance \nand hypothesis testing can be used individually.  ANOVA is used to \nsupport other statistical tools.  Regression is first used to fit more \ncomplex models to data, then ANOVA is used to compare models with the \nobjective of selecting simple(r) models that adequately describe the \ndata.  \"Such models could be fit without any reference to ANOVA, but \nANOVA tools could then be used to make some sense of the fitted models, \nand to test hypotheses about batches of coefficients.\"Gelman (2008)  \n\"[W]e think of the analysis of variance as a way of understanding and structuring \nmultilevel models—not as an alternative to regression but as a tool \nfor summarizing complex high-dimensional inferences ...\"\n\nFor a single factor\n\nThe simplest experiment suitable for ANOVA analysis is the completely \nrandomized experiment with a single factor.  More complex experiments \nwith a single factor involve constraints on randomization and include \ncompletely randomized blocks and Latin squares (and variants: \nGraeco-Latin squares, etc.).  The more complex experiments share many \nof the complexities of multiple factors.  A relatively complete \ndiscussion of the analysis (models, data summaries, ANOVA table) of \nthe completely randomized experiment is \navailable.\n\nFor multiple factors\n\nANOVA generalizes to the study of the effects of multiple factors.  \nWhen the experiment includes observations at all combinations of \nlevels of each factor, it is termed factorial.  \nFactorial experiments \nare more efficient than a series of single factor experiments and the \nefficiency grows as the number of factors increases.Montgomery \n(2001, Section 5-2: Introduction to factorial designs; The advantages \nof factorials)  Consequently, factorial designs are heavily used.\n\nThe use of ANOVA to study the effects of multiple factors has a complication.  In a 3-way ANOVA with factors x, y and z, the ANOVA model includes terms for the main effects (x, y, z) and terms for interactions (xy, xz, yz, xyz).  \nAll terms require hypothesis tests.  The proliferation of interaction terms increases the risk that some hypothesis test will produce a false positive by chance. Fortunately, experience says that high order interactions are rare.Belle (2008, Section 8.4: High-order interactions occur rarely)   \nThe ability to detect interactions is a major advantage of multiple \nfactor ANOVA.  Testing one factor at a time hides interactions, but \nproduces apparently inconsistent experimental results.\n\nCaution is advised when encountering interactions; Test  \ninteraction terms first and expand the analysis beyond ANOVA if \ninteractions are found.  Texts vary in their recommendations regarding \nthe continuation of the ANOVA procedure after encountering an \ninteraction.  Interactions complicate the interpretation of \nexperimental data.  Neither the calculations of significance nor the \nestimated treatment effects can be taken at face value.  \"A \nsignificant interaction will often mask the significance of main effects.\"Montgomery (2001, Section 5-1: Introduction to factorial designs; Basic definitions and principles)  Graphical methods are recommended\nto enhance understanding.  Regression is often useful.  A lengthy discussion of interactions is available in Cox (1958).Cox (1958, \nChapter 6: Basic ideas about factorial experiments)  Some interactions can be removed (by transformations) while others cannot.\n\nA variety of techniques are used with multiple factor ANOVA to reduce expense. One technique used in factorial designs is to minimize replication (possibly no replication with support of analytical trickery) and to combine groups when effects are found to be statistically (or practically) insignificant.  An experiment with many insignificant factors may collapse into one with a few factors supported by many replications.Montgomery (2001, Section 5-3.7: Introduction to factorial designs; The two-factor factorial design; One observation per cell)\n\nWorked numeric examples\n\nSeveral fully worked numerical examples are available.  A \nsimple case uses one-way (a single factor) analysis.  A more complex case uses two-way (two-factor) analysis.\n\nAssociated analysis\n\nSome analysis is required in support of the design of the experiment while other analysis is performed after changes in the factors are formally found to produce statistically significant changes in the responses.  Because experimentation is iterative, the results of one experiment alter plans for following experiments.\n\nPreparatory analysis\n\nThe number of experimental units\n\nIn the design of an experiment, the number of experimental units is planned to satisfy the goals of the experiment. Experimentation is often sequential.\n\nEarly experiments are often designed to provide mean-unbiased estimates of treatment effects and of experimental error. Later experiments are often designed to test a hypothesis that a treatment effect has an important magnitude; in this case, the number of experimental units is chosen so that the experiment is within budget and has adequate power, among other goals.\n\nReporting sample size analysis is generally required in psychology. \"Provide information on sample size and the process that led to sample size decisions.\"Wilkinson (1999, p 596)  The analysis, which is written in the experimental protocol before the experiment is conducted, is examined in grant applications and administrative review boards.\n\nBesides the power analysis, there are less formal methods for selecting the number of experimental units. These include graphical methods based on limiting\nthe probability of false negative errors, graphical methods based on an expected variation increase (above the residuals) and methods based on achieving a desired confident interval.Montgomery (2001, Section 3-7: Determining sample size)\n\nPower analysis\n\nPower analysis is often applied in the context of ANOVA in order to assess the probability of successfully rejecting the null hypothesis if we assume a certain ANOVA design, effect size in the population, sample size and significance level. Power analysis can assist in study design by determining what sample size would be required in order to have a reasonable chance of rejecting the null hypothesis when the alternative hypothesis is true.Howell (2002, Chapter 8: Power)Howell (2002, Section 11.12: Power (in ANOVA))Howell (2002, Section 13.7: Power analysis for factorial experiments)Moore and McCabe (2003, pp 778–780)\n\nEffect size\n\nSeveral standardized measures of effect have been proposed for ANOVA to summarize the strength of the association between a predictor(s) and the dependent variable or the overall standardized difference of the complete model. Standardized effect-size estimates facilitate comparison of findings across studies and disciplines.  However, while standardized effect sizes are commonly used in much of the professional literature, a non-standardized measure of effect size that has immediately \"meaningful\" units may be preferable for reporting purposes.Wilkinson (1999, p 599)\n\nFollow-up analysis\n\nIt is always appropriate to carefully consider outliers.  They have a disproportionate impact on statistical conclusions and are often the result of errors.\n\nModel confirmation\n\nIt is prudent to verify that the assumptions of ANOVA have been met. Residuals are examined or analyzed to confirm homoscedasticity and gross normality.Montgomery (2001, Section 3-4: Model adequacy checking)  Residuals should have the appearance of (zero mean normal distribution) noise when plotted as a function of anything including time and \nmodeled data values. Trends hint at interactions among factors or among observations.  One rule of thumb: \"If the largest standard deviation is less than twice the smallest standard deviation, we can use methods based on the assumption of equal standard deviations and our results \nwill still be approximately correct.\"Moore and McCabe (2003, p 755, Qualifications to this rule appear in a footnote.)\n\nFollow-up tests\n\nA statistically significant effect in ANOVA is often followed up with one or more different follow-up tests. This can be done in order to assess which groups are different from which other groups or to test various other focused hypotheses. Follow-up tests are often distinguished in terms of whether they are planned (a priori) or post hoc. Planned tests are determined before looking at the data and post hoc tests are performed after looking at the data.\n\nOften one of the \"treatments\" is none, so the treatment group can act as a control.  Dunnett's test (a modification of the t-test) tests whether each of the other treatment groups has the same \nmean as the control.Montgomery (2001, Section 3-5.8: Experiments with a single factor: The analysis of \nvariance; Practical interpretation of results; Comparing means with a control)\n\nPost hoc tests such as Tukey's range test most commonly compare every group mean with every other group mean and typically incorporate some method of controlling for Type I errors. Comparisons, which are most commonly planned, can be either simple or compound. Simple comparisons compare one group mean with one other group mean. Compound comparisons typically compare two sets of groups means where one set has two or more groups (e.g., compare average group means of group A, B and C with group D). Comparisons can also look at tests of trend, such as linear and quadratic relationships, when the independent variable involves ordered levels.\n\nFollowing ANOVA with pair-wise multiple-comparison tests has been criticized on several grounds.Hinkelmann and Kempthorne (2008, Volume 1, Section 7.5: \nComparison of Treatments; Multiple Comparison Procedures) There are many such tests (10 in one table) and recommendations regarding their use are vague or conflicting.Howell (2002, Chapter 12: Multiple comparisons among treatment means)Montgomery (2001, Section 3-5: Practical interpretation of results)\n\nStudy designs\n\nThere are several types of ANOVA. Many statisticians base ANOVA on the design of the experiment,Cochran & Cox (1957, p 9,\n\"[T]he general rule [is] that the way in which the experiment is conducted determines not only whether inferences can be made, but also the calculations required to make them.\") especially on the protocol that specifies the random assignment of treatments to subjects; the protocol's description of the assignment mechanism should include a specification of the structure of the treatments and of any blocking. It is also common to apply ANOVA to observational data using an appropriate statistical model.\n\nSome popular designs use the following types of ANOVA:\n*One-way ANOVA is used to test for differences among two or more independent groups (means),e.g. different levels of urea application in a crop, or different levels of antibiotic action on several bacterial species,[http://www.biomedicalstatistics.info/en/multiplegroups/one-way-anova.html One-way/single factor ANOVA. Biomedical Statistics]  or different levels of effect of some medicine on groups of patients. Typically, however, the one-way ANOVA is used to test for differences among at least three groups, since the two-group case can be covered by a t-test. When there are only two means to compare, the t-test and the ANOVA F-test are equivalent; the relation between ANOVA and t is given by F = t2.\n*Factorial ANOVA is used when the experimenter wants to study the interaction effects among the treatments.\n*Repeated measures ANOVA is used when the same subjects are used for each treatment (e.g., in a longitudinal study).\n*Multivariate analysis of variance (MANOVA) is used when there is more than one response variable.\n\nCautions\n\nBalanced experiments (those with an equal sample size for each treatment) are relatively easy to interpret; Unbalanced \nexperiments offer more complexity.  For single factor (one way) ANOVA, the adjustment for unbalanced data is easy, but the unbalanced analysis lacks both robustness and power.Montgomery (2001, Section 3-3.4: Unbalanced data)  For more complex designs the lack of balance leads to further complications. \"The orthogonality property of main effects and interactions present in balanced data does not carry over to the unbalanced case. This means that the usual analysis of variance techniques do not apply.  \nConsequently, the analysis of unbalanced factorials is much more difficult than that for balanced designs.\"Montgomery (2001, Section 14-2: Unbalanced data in factorial design)  In the general case, \"The analysis of variance can also be applied to unbalanced data, but then the sums of squares, mean squares, and F-ratios will depend on the order in which the sources of variation \nare considered.\"  The simplest techniques for handling unbalanced data restore balance by either throwing out data or by synthesizing missing data.  More complex techniques use regression.\n\nANOVA is (in part) a significance test.  The American Psychological Association holds the view that simply reporting significance is insufficient and that reporting confidence bounds is preferred.\n\nWhile ANOVA is conservative (in maintaining a significance level) against multiple comparisons in one dimension, it is not conservative against comparisons in multiple dimensions.Wilkinson (1999, p 600)\n\nGeneralizations\n\nANOVA is considered to be a special case of linear regressionGelman (2005, p.1) (with qualification in the later text)Montgomery (2001, Section 3.9: The Regression Approach to the Analysis of Variance) which in turn is a special case of the general linear model.Howell (2002, p 604) All consider the observations to be the sum of a model (fit) and a residual (error) to be minimized.\n\nThe Kruskal–Wallis test and the Friedman test are nonparametric tests, which  do not rely on an assumption of normality.Howell (2002, Chapter 18: Resampling and nonparametric approaches to data)Montgomery (2001, Section 3-10: Nonparametric methods in the analysis of variance)\n\nConnection to linear regression\n\nBelow we make clear the connection between multi-way ANOVA and linear regression. Linearly re-order the data so that k^\\text{th} observation is associated with a response y_k and factors Z_{k,b} where b \\in \\{1,2,\\ldots,B\\} denotes the different factors and B is the total number of factors. In one-way ANOVA B1 and in two-way ANOVA B\n2. Furthermore, we assume the b^{th} factor has I_b levels. Now, we can one-hot encode the factors into the  \\sum_{b=1}^B I_b dimensional vector v_k.\n\nThe one-hot encoding function g_b : I_b \\mapsto \\{0,1\\}^{I_b} is defined such that the i^{th} entry of g_b(Z_{k,b}) is\n\ng_b(Z_{k,b})_i \\begin{cases} 1 & \\text{if } i\nZ_{k,b} \\\\\n 0 & \\text{otherwise} \\end{cases}\n\nThe vector v_k is the concatenation of all of the above vectors for all b. Thus, v_k = [g_1(Z_{k,1}), g_2(Z_{k,2}), \\ldots, g_B(Z_{k,B})]. In order to obtain a fully general B-way interaction ANOVA we must also concatenate every additional interaction term in the vector v_k and then add an intercept term.  Let that vector be x_k.\n\nWith this notation in place, we now have the exact connection with linear regression. We simply regress response y_k against the vector X_k. However, there is a concern about identifiability. In order to overcome such issues we assume that the sum of the parameters within each set of interactions is equal to zero. From here, one can use F-statistics or other methods to determine the relevance of the individual factors.\n\nExample\n\nWe can consider the 2-way interaction example where we assume that the first factor has 2 levels and the second factor has 3 levels.\n\nDefine a_i 1 if Z_{k,1}\ni and b_i 1 if Z_{k,2}\ni, i.e. a is the one-hot encoding of the first factor and b is the one-hot encoding of the second factor.\n\nWith that,\n\nX_k = [a_1,a_2,b_1,b_2,b_3,a_1 \\times b_1,a_1 \\times b_2, a_1 \\times b_3, a_2 \\times b_1, a_2 \\times b_2, a_2 \\times b_3,1]\n\nwhere the last term is an intercept term. For a more concrete example suppose that\n\n\\begin{align}\nZ_{k,1} & = 2 \\\\\nZ_{k,2} & = 1\n\\end{align}\n\nThen,\n\nX_k = [0,1,1,0,0,0,0,0,1,0,0,1]",
  "entityProperties" : [ {
    "name" : "title",
    "type" : "String",
    "values" : [ "Analysis of variance" ],
    "synthetic" : false
  }, {
    "name" : "url",
    "type" : "String",
    "values" : [ "http://en.wikipedia.org/?curid=634" ],
    "synthetic" : false
  } ],
  "classifications" : [ "xml-export" ],
  "technicalAttributes" : {
    "technicalAttributes" : null,
    "aggregatedText" : "Analysis of variance (ANOVA) is a collection of statistical models and their associated procedures (such as \"variation\" among and between groups) used to analyze the differences among group means. ANOVA was developed by statistician and evolutionary biologist Ronald Fisher. In the ANOVA setting, the observed variance in a particular variable is partitioned into components attributable to different sources of variation. In its simplest form, ANOVA provides a statistical test of whether or not the means of several groups are equal, and therefore generalizes the t-test to more than two groups.   ANOVAs are useful for comparing (testing) three or more means (groups or variables) for statistical significance.  It is conceptually similar to multiple two-sample t-tests, but is more conservative (results in less type I error)  and is therefore suited to a wide range of practical problems.\n\nHistory\n\nWhile the analysis of variance reached fruition in the 20th century, antecedents extend centuries into the past according to Stigler.Stigler (1986)  These include hypothesis testing, the partitioning of sums of squares, experimental techniques and the additive model. Laplace was performing hypothesis testing in the 1770s.Stigler (1986, p 134) The development of least-squares methods by Laplace and Gauss circa 1800 provided an improved method of combining observations (over the existing practices then used in astronomy and geodesy). It also initiated much study of the contributions to sums of squares. Laplace soon knew how to estimate a variance from a residual (rather than a total) sum of squares.Stigler (1986, p 153) By 1827 Laplace was using least squares methods to address ANOVA problems regarding measurements of atmospheric tides.Stigler (1986, pp 154–155) Before 1800 astronomers had isolated observational errors resulting \nfrom reaction times (the \"personal equation\") and had developed methods of reducing the errors.Stigler (1986, pp 240–242)  The experimental methods used in the study of the personal equation were later accepted by the emerging field of psychology Stigler (1986, \nChapter 7 - Psychophysics as a Counterpoint) which developed strong (full factorial) experimental methods to which randomization and blinding were soon added.Stigler (1986, p 253)  An eloquent non-mathematical explanation of the additive effects model was\navailable in 1885.Stigler (1986, pp 314–315)\n\nRonald Fisher introduced the term variance and proposed its formal analysis in a 1918 article The Correlation Between Relatives on the Supposition of Mendelian Inheritance.The Correlation Between Relatives on the Supposition of Mendelian Inheritance. Ronald A. Fisher. Philosophical Transactions of the Royal Society of Edinburgh. 1918. (volume 52, pages 399–433)  His first application of the analysis of variance was published in 1921.On the \"Probable Error\" of a Coefficient of Correlation Deduced from a Small Sample. Ronald A. Fisher. Metron, 1: 3-32 (1921) Analysis of variance became widely known after being included in Fisher's 1925 book Statistical Methods for Research Workers.\n\nRandomization models were developed by several researchers.  The first was published in Polish by Jerzy Neyman in 1923.Scheffé (1959, p 291, \"Randomization models were first formulated by Neyman (1923) for the completely randomized design, by Neyman (1935) for randomized blocks, by Welch (1937) and Pitman (1937) for the Latin square under a certain null hypothesis, and by Kempthorne (1952, 1955) and Wilk (1955) for many other designs.\")\n\nOne of the attributes of ANOVA which ensured its early popularity was computational elegance.  The structure of the additive model allows solution for the additive coefficients by simple algebra rather than by matrix calculations.  In the era of mechanical calculators this simplicity was critical.  The determination of statistical significance also required access to tables of the F function which were supplied by early statistics texts.\n\nMotivating example\n\nThe analysis of variance can be used as an exploratory tool to explain observations.  A dog show provides an example.  A dog show is not a random sampling of the breed: it is typically limited to dogs that are adult, pure-bred, and exemplary.  A histogram of dog weights from a show might plausibly be rather complex, like the yellow-orange distribution shown in the illustrations.  Suppose we wanted to predict the weight of a dog based on a certain set of characteristics of each dog. One way to do that is to explain the distribution of weights by dividing the dog population into groups based on those characteristics. A successful grouping will split dogs such that (a) each group has a low variance of dog weights (meaning the group is relatively homogeneous) and (b) the mean of each group is distinct (if two groups have the same mean, then it isn't reasonable to conclude that the groups are, in fact, separate in any meaningful way).\nIn the illustrations to the right, groups are identified as X1, X2, etc. In the first illustration, the dogs are divided according to the product (interaction) of two binary groupings: young vs old, and short-haired vs long-haired (e.g., group 1 is young, short-haired dogs, group 2 is young, long-haired dogs, etc.). Since the distributions of dog weight within each of the groups (shown in blue) has a relatively large variance, and since the means are very similar across groups, grouping dogs by these characteristics does not produce an effective way to explain the variation in dog weights: knowing which group a dog is in doesn't allow us to predict its weight much better than simply knowing the dog is in a dog show. Thus, this grouping fails to explain the variation in the overall distribution (yellow-orange).\n\nAn attempt to explain the weight distribution by grouping dogs as pet vs working breed and less athletic vs more athletic would probably be somewhat more successful (fair fit).  The heaviest show dogs are likely to be big strong working breeds, while breeds kept as pets tend to be smaller and thus lighter.  As shown by the second illustration, the distributions have variances that are considerably smaller than in the first case, and the means are more distinguishable. However, the significant overlap of distributions, for example, means that we cannot distinguish X1 and X2 reliably. Grouping dogs according to a coin flip might produce distributions that look similar.\n\nAn attempt to explain weight by breed is likely to produce a very good fit.  All Chihuahuas are light and all St Bernards are heavy.  The difference in weights between Setters and Pointers does not justify separate breeds.  The analysis of variance provides the formal tools to justify these intuitive judgments.  A common use of the method is the analysis of experimental data or the development of models.  The method has some advantages over correlation: not all of the data must be numeric and one result of the method is a judgment in the confidence in an explanatory relationship.\n\nBackground and terminology\n\nANOVA is a particular form of statistical hypothesis testing heavily used in the analysis of experimental data.  A test  result (calculated from the null hypothesis and the sample) is called statistically significant if it is deemed unlikely to have occurred by chance, assuming the truth of the null hypothesis. A statistically significant result, when a probability (p-value) is less than a threshold (significance level), justifies the rejection of the null hypothesis, but only if the a priori probability of the null hypothesis is not high.\n\nIn the typical application of ANOVA, the null hypothesis is that all groups are simply random samples of the same population. For example, when studying the effect of different treatments on similar samples of patients, the null hypothesis would be that all treatments have the same effect (perhaps none). Rejecting the null hypothesis is taken to mean that the differences in observed effects between treatment groups is unlikely to be due to random chance.\n\nBy construction, hypothesis testing limits the rate of Type I errors (false positives) to a significance level.  Experimenters also wish to limit Type II errors (false negatives).  \nThe rate of Type II errors depends largely on sample size (the rate will increase for small numbers of samples), significance \nlevel (when the standard of proof is high, the chances of overlooking \na discovery are also high) and effect size (a smaller effect size is more prone to Type II error).\n\nThe terminology of ANOVA is largely from the statistical \ndesign of experiments.  The experimenter adjusts factors and \nmeasures responses in an attempt to determine an effect.  Factors are \nassigned to experimental units by a combination of randomization and \nblocking to ensure the validity of the results.  Blinding keeps the\nweighing impartial.  Responses show a variability that is partially \nthe result of the effect and is partially random error.\n\nANOVA is the synthesis of several ideas and it is used for multiple \npurposes.  As a consequence, it is difficult to define concisely or precisely.\n\n\"Classical\" ANOVA for balanced data does three things at once:\n\nIn short, ANOVA is a statistical tool used in several ways to develop and confirm an explanation for the observed data.\n\nAdditionally:\n\nAs a result:\nANOVA \"has long enjoyed the status of being the most used (some would \nsay abused) statistical technique in psychological research.\"\nHowell (2002, p 320)\nANOVA \"is probably the most useful technique in the field of \nstatistical inference.\"Montgomery (2001, p 63)\n\nANOVA is difficult to teach, particularly for complex experiments, with split-plot designs being notorious.Gelman (2005, p 1)  In some cases the proper \napplication of the method is best determined by problem pattern recognition \nfollowed by the consultation of a classic authoritative test.\nGelman (2005, p 5)\n\nDesign-of-experiments terms\n\n(Condensed from the NIST Engineering Statistics handbook: Section 5.7. A \nGlossary of DOE Terminology.)\n\n; Balanced design: An experimental design where all cells (i.e. treatment combinations) have the same number of observations.\n; Blocking: A schedule for conducting treatment combinations in an experimental study such that any effects on the experimental results due to a known change in raw materials, operators, machines, etc., become concentrated in the levels of the blocking variable. The reason for blocking is to isolate a systematic effect and prevent it from obscuring the main effects. Blocking is achieved by restricting randomization.\n; Design: A set of experimental runs which allows the fit of a particular model and the estimate of effects.\n; DOE: Design of experiments.  An approach to problem solving involving collection of data that will support valid, defensible, and supportable conclusions.\n; Effect: How changing the settings of a factor changes the response. The effect of a single factor is also called a main effect.\n; Error: Unexplained variation in a collection of observations. DOE's typically require understanding of both random error and lack of fit error.\n; Experimental unit: The entity to which a specific treatment combination is applied.\n; Factors: Process inputs that an investigator manipulates to cause a change in the output.\n; Lack-of-fit error: Error that occurs when the analysis omits one or more important terms or factors from the process model. Including replication in a DOE allows separation of experimental error into its components: lack of fit and random (pure) error.\n; Model: Mathematical relationship which relates changes in a given response to changes in one or more factors.\n; Random error: Error that occurs due to natural variation in the process. Random error is typically assumed to be normally distributed with zero mean and a constant variance. Random error is also called experimental error.\n; Randomization: A schedule for allocating treatment material and for conducting treatment combinations in a DOE such that the conditions in one run neither depend on the conditions of the previous run nor predict the conditions in the subsequent runs.Randomization is a term used in multiple ways in this\nmaterial.  \"Randomization has three roles in applications: as a device \nfor eliminating biases, for example from unobserved explanatory \nvariables and selection effects: as a basis for estimating standard \nerrors: and as a foundation for formally exact significance tests.\"  \nCox (2006, page 192)  Hinkelmann and Kempthorne use randomization \nboth in experimental design and for statistical analysis.\n; Replication: Performing the same treatment combination more than once. Including replication allows an estimate of the random error independent of any lack of fit error.\n; Responses: The output(s) of a process. Sometimes called dependent variable(s).\n; Treatment: A treatment is a specific combination of factor levels whose effect is to be compared with other treatments.\n\nClasses of models \n\nThere are three classes of models used in the analysis of variance, and these are outlined here.\n\nFixed-effects models\n\nThe fixed-effects model (class I) of analysis of variance applies to situations in which the experimenter applies one or more treatments to the subjects of the experiment to see whether the response variable values change. This allows the experimenter to estimate the ranges of response variable values that the treatment would generate in the population as a whole.\n\nRandom-effects models\n\nRandom effects model (class II) is used when the treatments are not fixed. This occurs when the various factor levels are sampled from a larger population. Because the levels themselves are random variables, some assumptions and the method of contrasting the treatments (a multi-variable generalization of simple differences) differ from the fixed-effects model.Montgomery (2001, Chapter 12: Experiments with random factors)\n\nMixed-effects models\n\nA mixed-effects model (class III) contains experimental factors of both fixed and random-effects types, with appropriately different interpretations and analysis for the two types.\n\nExample:\nTeaching experiments could be performed by a college or university department \nto find a good introductory textbook, with each text considered a \ntreatment.  The fixed-effects model would compare a list of candidate \ntexts.  The random-effects model would determine whether important \ndifferences exist among a list of randomly selected texts.  The \nmixed-effects model would compare the (fixed) incumbent texts to \nrandomly selected alternatives.\n\nDefining fixed and random effects has proven elusive, with competing \ndefinitions arguably leading toward a linguistic quagmire.\nGelman (2005, pp. 20–21)\n\nAssumptions\n\nThe analysis of variance has been studied from several approaches, the most common of which uses a linear model that relates the response to the treatments and blocks. Note that the model is linear in parameters but may be nonlinear across factor levels. Interpretation is easy when data is balanced across factors but much deeper understanding is needed for unbalanced data.\n\nTextbook analysis using a normal distribution\n\nThe analysis of variance can be presented in terms of a linear model, which makes the following assumptions about the probability distribution of the responses:Cochran & Cox (1992, p 48)Howell (2002, p 323)\n\n* Independence of observations – this is an assumption of the model that simplifies the statistical analysis.\n* Normality – the distributions of the residuals are normal.\n* Equality (or \"homogeneity\") of variances, called homoscedasticity — the variance of data in groups should be the same.\n\nThe separate assumptions of the textbook model imply that the errors are independently, identically, and normally distributed for fixed effects models, that is, that the errors (\\varepsilon) are independent and\n\n\\varepsilon \\thicksim N(0, \\sigma^2).\\,\n\nRandomization-based analysis\n\nIn a randomized controlled experiment, the treatments are randomly assigned to experimental units, following the experimental protocol. This randomization is objective and declared before the experiment is carried out. The objective random-assignment is used to test the significance of the null hypothesis, following the ideas of C. S. Peirce and Ronald Fisher. This design-based analysis was discussed and developed by Francis J. Anscombe at Rothamsted Experimental Station and by Oscar Kempthorne at Iowa State University.Anscombe (1948) Kempthorne and his students make an assumption of unit treatment additivity, which is discussed in the books of Kempthorne and David R. Cox.\n\nUnit-treatment additivity\n\nIn its simplest form, the assumption of unit-treatment additivityUnit-treatment additivity is simply termed additivity\nin most texts.  Hinkelmann and Kempthorne add adjectives and\ndistinguish between additivity in the strict and broad senses.  This \nallows a detailed consideration of multiple error sources (treatment, \nstate, selection, measurement and sampling) on page 161. states that the observed response y_{i,j} from experimental unit i when receiving treatment j can be written as the sum of the unit's response y_i and the treatment-effect  t_j, that is Kempthorne (1979, p 30)Cox (1958, Chapter 2: Some Key Assumptions)Hinkelmann and Kempthorne (2008, Volume 1, Throughout.  Introduced in Section 2.3.3: Principles of experimental design; The linear model; Outline of a model)\ny_{i,j}=y_i+t_j.\nThe assumption of unit-treatment additivity implies that, for every treatment j, the jth treatment has  exactly the same effect t_j on every experiment unit.\n\nThe assumption of unit treatment additivity  usually cannot be directly falsified, according to Cox and Kempthorne. However, many consequences of treatment-unit additivity can be falsified. For a randomized experiment, the assumption of unit-treatment additivity implies that the variance is constant for all treatments. Therefore, by contraposition, a necessary condition for unit-treatment additivity is that the variance is constant.\n\nThe use of unit treatment additivity and randomization is similar to the design-based inference that is standard in finite-population survey sampling.\n\nDerived linear model\n\nKempthorne uses the randomization-distribution and the assumption of unit treatment additivity to produce a derived linear model, very similar to the textbook model discussed previously.Hinkelmann and Kempthorne (2008, Volume 1, Section 6.3: \nCompletely Randomized Design; Derived Linear Model)  The test statistics of this derived linear model are closely approximated by the test statistics of an appropriate normal linear model, according to approximation theorems and simulation studies.Hinkelmann and Kempthorne (2008, Volume 1, Section 6.6: Completely randomized design; Approximating the randomization test) However, there are differences. For example, the randomization-based analysis results in a small but (strictly) negative correlation between the observations.Bailey (2008, Chapter 2.14 \"A More General Model\" in Bailey, pp. 38–40)Hinkelmann and Kempthorne (2008, Volume 1, Chapter 7: Comparison of Treatments) In the randomization-based analysis, there is no assumption of a normal distribution and certainly no assumption of independence. On the contrary, the observations are dependent!\n\nThe randomization-based analysis has the disadvantage that its exposition involves tedious algebra and extensive time.  Since the randomization-based analysis is complicated and is closely approximated by the approach using a normal linear model, most teachers emphasize the normal linear model approach. Few statisticians object to model-based analysis of balanced randomized experiments.\n\nStatistical models for observational data\n\nHowever, when applied to data from non-randomized experiments or observational studies, model-based analysis lacks the warrant of randomization.\nKempthorne (1979, pp 125–126, \n\"The experimenter must decide which of the various causes that he \nfeels will produce variations in his results must be controlled \nexperimentally.  Those causes that he does not control experimentally, \nbecause he is not cognizant of them, he must control by the device of \nrandomization.\"  \"[O]nly when the treatments in the experiment are \napplied by the experimenter using the full randomization procedure is \nthe chain of inductive inference sound.  It is only under these \ncircumstances that the experimenter can attribute whatever effects he \nobserves to the treatment and the treatment only.  Under these \ncircumstances his conclusions are reliable in the statistical sense.\")  \n For observational data, the derivation of confidence intervals must use subjective models, as emphasized by Ronald Fisher and his followers. In practice, the estimates of treatment-effects from observational studies  generally are often inconsistent.  In practice, \"statistical models\" and observational data are useful for suggesting hypotheses that should be treated very cautiously by the public.Freedman \n\nSummary of assumptions\n\nThe normal-model based ANOVA analysis assumes the independence, normality and \nhomogeneity of the variances of the residuals. The \nrandomization-based analysis assumes only the homogeneity of the \nvariances of the residuals (as a consequence of unit-treatment \nadditivity) and uses the randomization procedure of the experiment. \nBoth these analyses require homoscedasticity, as an assumption for the normal-model analysis and as a consequence of randomization and additivity for the randomization-based analysis.\n\nHowever, studies of processes that \nchange variances rather than means (called dispersion effects) have \nbeen successfully conducted using ANOVA.Montgomery \n(2001, Section 3.8: Discovering dispersion effects)  There are\nno necessary assumptions for ANOVA in its full generality, but the\nF-test used for ANOVA hypothesis testing has assumptions and practical \nlimitations which are of continuing interest.\n\nProblems which do not satisfy the assumptions of ANOVA can often be transformed to satisfy the assumptions. \nThe property of unit-treatment additivity is not invariant under a \"change of scale\", so statisticians often use transformations to achieve unit-treatment additivity. If the response variable is expected to follow a parametric family of probability distributions, then the statistician may specify (in the protocol for the experiment or observational study) that the responses be transformed to stabilize the variance.Hinkelmann and Kempthorne (2008, Volume 1, Section 6.10: Completely randomized design; Transformations) Also, a statistician may specify that logarithmic transforms be applied to the responses, which are believed to follow a multiplicative model.Bailey (2008)\nAccording to Cauchy's functional equation theorem, the logarithm is the only continuous transformation that transforms real multiplication to addition.\n\nCharacteristics\n\nANOVA is used in the analysis of comparative experiments, those in \nwhich only the difference in outcomes is of interest.  The statistical\nsignificance of the experiment is determined by a ratio of two \nvariances.  This ratio is independent of several possible alterations\nto the experimental observations: Adding a constant to all \nobservations does not alter significance.  Multiplying all \nobservations by a constant does not alter significance.  So ANOVA \nstatistical significance result is independent of constant bias and \nscaling errors as well as the units used in expressing observations.  \nIn the era of mechanical calculation it was common to \nsubtract a constant from all observations (when equivalent to \ndropping leading digits) to simplify data entry.Montgomery \n(2001, Section 3-3: Experiments with a single factor: The analysis of \nvariance; Analysis of the fixed effects model)\nCochran & Cox (1992, p 2 example)  This is an example of data\ncoding.\n\nLogic\n\nThe calculations of ANOVA can be characterized as computing a number\nof means and variances, dividing two variances and comparing the ratio \nto a handbook value to determine statistical significance.  Calculating \na treatment effect is then trivial, \"the effect of any treatment is \nestimated by taking the difference between the mean of the \nobservations which receive the treatment and the general mean\".\nCochran & Cox (1992, p 49)\n\nPartitioning of the sum of squares\n\nANOVA uses traditional standardized terminology.  The definitional \nequation of sample variance is\ns^2=\\textstyle\\frac{1}{n-1}\\sum(y_i-\\bar{y})^2, where the \ndivisor is called the degrees of freedom (DF), the summation is called \nthe sum of squares (SS), the result is called the mean square (MS) and \nthe squared terms are deviations from the sample mean.  ANOVA \nestimates 3 sample variances: a total variance based on all the \nobservation deviations from the grand mean, an error variance based on \nall the observation deviations from their appropriate \ntreatment means, and a treatment variance.  The treatment variance is\nbased on the deviations of treatment means from the grand mean, the \nresult being multiplied by the number of observations in each \ntreatment to account for the difference between the variance of \nobservations and the variance of means.\n\nThe fundamental technique is a partitioning of the total sum of squares SS into components related to the effects used in the model. For example, the model for a simplified ANOVA with one type of treatment at different levels.\n\nSS_\\text{Total} = SS_\\text{Error} + SS_\\text{Treatments}\n\nThe number of degrees of freedom DF can be partitioned in a similar way: one of these components (that for error) specifies a chi-squared distribution which describes the associated sum of squares, while the same is true for \"treatments\" if there is no treatment effect.\n\nDF_\\text{Total} = DF_\\text{Error} + DF_\\text{Treatments}\n\nSee also Lack-of-fit sum of squares.\n\nThe F-test\n\nThe F-test is used for comparing the factors of the total deviation. For example, in one-way, or single-factor ANOVA, statistical significance is tested for by comparing the F test statistic\n\nF = \\frac{\\text{variance between treatments}}{\\text{variance within treatments}}\n\nF \\frac{MS_\\text{Treatments}}{MS_\\text{Error}} \n \nwhere  MS is mean square, I  = number of treatments and \nn_T = total number of cases\n\nto the F-distribution with I - 1, n_T - I  degrees of freedom. Using the F-distribution is a natural candidate because the test statistic is the ratio of two scaled sums of squares each of which follows a scaled chi-squared distribution.\n\nThe expected value of F is 1 + {n \\sigma^2_\\text{Treatment}} / \n{\\sigma^2_\\text{Error}} (where n is the treatment sample size)\nwhich is 1 for no treatment effect.  As values of F increase above 1, the evidence is increasingly inconsistent with the null hypothesis. Two apparent experimental methods of increasing F are increasing the sample size and reducing the error variance by tight experimental controls.\n\nThere are two methods of concluding the ANOVA hypothesis test, both of which produce the same result:\n* The textbook method is to compare the observed value of F with the critical value of F determined from tables. The critical value of F is a function of the degrees of freedom of the numerator and the denominator and the significance level (α).  If F ≥ FCritical, the null hypothesis is rejected.\n* The computer method calculates the probability (p-value) of a value of F greater than or equal to the observed value.  The null hypothesis is rejected if this probability is less than or equal to the significance level (α).\nThe ANOVA F-test is known to be nearly optimal in the sense of minimizing false negative errors for a fixed rate of false positive errors (i.e. maximizing power for a fixed significance level). For example, to test the hypothesis that various medical treatments have exactly the same effect, the F-test's p-values closely approximate the permutation test's p-values: The approximation is particularly close when the design is balanced.Hinkelmann and Kempthorne (2008, Volume 1, Section 6.7: Completely randomized design; CRD with unequal numbers of replications) Such permutation tests characterize tests with maximum power against all alternative hypotheses, as observed by Rosenbaum.Rosenbaum (2002, page 40) cites Section 5.7 (Permutation Tests), Theorem 2.3 (actually Theorem 3, page 184) of Lehmann's Testing Statistical Hypotheses (1959). The ANOVA F–test (of the null-hypothesis that all treatments have exactly the same effect) is recommended as a practical test, because of its robustness against many alternative distributions.Moore and McCabe (2003, page 763)The F-test for the comparison of variances has a mixed reputation.  It \nis not recommended as a hypothesis test to determine whether two \ndifferent samples have the same variance.  It is recommended for \nANOVA where two estimates of the variance of the same \nsample are compared.  While the F-test is not generally robust against \ndepartures from normality, it has been found to be robust in the \nspecial case of ANOVA.  Citations from Moore & McCabe (2003): \n\"Analysis of variance uses F statistics, but these are not \nthe same as the F statistic for comparing two population standard \ndeviations.\" (page 554) \"The F test and other procedures for inference \nabout variances are so lacking in robustness as to be of little use in \npractice.\" (page 556)  \"[The ANOVA F test] is relatively insensitive \nto moderate nonnormality and unequal variances, especially when the \nsample sizes are similar.\" (page 763)  ANOVA assumes homoscedasticity, \nbut it is robust.  The statistical test for homoscedasticity (the \nF-test) is not robust.  Moore & McCabe recommend a rule of thumb.\n\nExtended logic\n\nANOVA consists of separable parts; partitioning sources of variance \nand hypothesis testing can be used individually.  ANOVA is used to \nsupport other statistical tools.  Regression is first used to fit more \ncomplex models to data, then ANOVA is used to compare models with the \nobjective of selecting simple(r) models that adequately describe the \ndata.  \"Such models could be fit without any reference to ANOVA, but \nANOVA tools could then be used to make some sense of the fitted models, \nand to test hypotheses about batches of coefficients.\"Gelman (2008)  \n\"[W]e think of the analysis of variance as a way of understanding and structuring \nmultilevel models—not as an alternative to regression but as a tool \nfor summarizing complex high-dimensional inferences ...\"\n\nFor a single factor\n\nThe simplest experiment suitable for ANOVA analysis is the completely \nrandomized experiment with a single factor.  More complex experiments \nwith a single factor involve constraints on randomization and include \ncompletely randomized blocks and Latin squares (and variants: \nGraeco-Latin squares, etc.).  The more complex experiments share many \nof the complexities of multiple factors.  A relatively complete \ndiscussion of the analysis (models, data summaries, ANOVA table) of \nthe completely randomized experiment is \navailable.\n\nFor multiple factors\n\nANOVA generalizes to the study of the effects of multiple factors.  \nWhen the experiment includes observations at all combinations of \nlevels of each factor, it is termed factorial.  \nFactorial experiments \nare more efficient than a series of single factor experiments and the \nefficiency grows as the number of factors increases.Montgomery \n(2001, Section 5-2: Introduction to factorial designs; The advantages \nof factorials)  Consequently, factorial designs are heavily used.\n\nThe use of ANOVA to study the effects of multiple factors has a complication.  In a 3-way ANOVA with factors x, y and z, the ANOVA model includes terms for the main effects (x, y, z) and terms for interactions (xy, xz, yz, xyz).  \nAll terms require hypothesis tests.  The proliferation of interaction terms increases the risk that some hypothesis test will produce a false positive by chance. Fortunately, experience says that high order interactions are rare.Belle (2008, Section 8.4: High-order interactions occur rarely)   \nThe ability to detect interactions is a major advantage of multiple \nfactor ANOVA.  Testing one factor at a time hides interactions, but \nproduces apparently inconsistent experimental results.\n\nCaution is advised when encountering interactions; Test  \ninteraction terms first and expand the analysis beyond ANOVA if \ninteractions are found.  Texts vary in their recommendations regarding \nthe continuation of the ANOVA procedure after encountering an \ninteraction.  Interactions complicate the interpretation of \nexperimental data.  Neither the calculations of significance nor the \nestimated treatment effects can be taken at face value.  \"A \nsignificant interaction will often mask the significance of main effects.\"Montgomery (2001, Section 5-1: Introduction to factorial designs; Basic definitions and principles)  Graphical methods are recommended\nto enhance understanding.  Regression is often useful.  A lengthy discussion of interactions is available in Cox (1958).Cox (1958, \nChapter 6: Basic ideas about factorial experiments)  Some interactions can be removed (by transformations) while others cannot.\n\nA variety of techniques are used with multiple factor ANOVA to reduce expense. One technique used in factorial designs is to minimize replication (possibly no replication with support of analytical trickery) and to combine groups when effects are found to be statistically (or practically) insignificant.  An experiment with many insignificant factors may collapse into one with a few factors supported by many replications.Montgomery (2001, Section 5-3.7: Introduction to factorial designs; The two-factor factorial design; One observation per cell)\n\nWorked numeric examples\n\nSeveral fully worked numerical examples are available.  A \nsimple case uses one-way (a single factor) analysis.  A more complex case uses two-way (two-factor) analysis.\n\nAssociated analysis\n\nSome analysis is required in support of the design of the experiment while other analysis is performed after changes in the factors are formally found to produce statistically significant changes in the responses.  Because experimentation is iterative, the results of one experiment alter plans for following experiments.\n\nPreparatory analysis\n\nThe number of experimental units\n\nIn the design of an experiment, the number of experimental units is planned to satisfy the goals of the experiment. Experimentation is often sequential.\n\nEarly experiments are often designed to provide mean-unbiased estimates of treatment effects and of experimental error. Later experiments are often designed to test a hypothesis that a treatment effect has an important magnitude; in this case, the number of experimental units is chosen so that the experiment is within budget and has adequate power, among other goals.\n\nReporting sample size analysis is generally required in psychology. \"Provide information on sample size and the process that led to sample size decisions.\"Wilkinson (1999, p 596)  The analysis, which is written in the experimental protocol before the experiment is conducted, is examined in grant applications and administrative review boards.\n\nBesides the power analysis, there are less formal methods for selecting the number of experimental units. These include graphical methods based on limiting\nthe probability of false negative errors, graphical methods based on an expected variation increase (above the residuals) and methods based on achieving a desired confident interval.Montgomery (2001, Section 3-7: Determining sample size)\n\nPower analysis\n\nPower analysis is often applied in the context of ANOVA in order to assess the probability of successfully rejecting the null hypothesis if we assume a certain ANOVA design, effect size in the population, sample size and significance level. Power analysis can assist in study design by determining what sample size would be required in order to have a reasonable chance of rejecting the null hypothesis when the alternative hypothesis is true.Howell (2002, Chapter 8: Power)Howell (2002, Section 11.12: Power (in ANOVA))Howell (2002, Section 13.7: Power analysis for factorial experiments)Moore and McCabe (2003, pp 778–780)\n\nEffect size\n\nSeveral standardized measures of effect have been proposed for ANOVA to summarize the strength of the association between a predictor(s) and the dependent variable or the overall standardized difference of the complete model. Standardized effect-size estimates facilitate comparison of findings across studies and disciplines.  However, while standardized effect sizes are commonly used in much of the professional literature, a non-standardized measure of effect size that has immediately \"meaningful\" units may be preferable for reporting purposes.Wilkinson (1999, p 599)\n\nFollow-up analysis\n\nIt is always appropriate to carefully consider outliers.  They have a disproportionate impact on statistical conclusions and are often the result of errors.\n\nModel confirmation\n\nIt is prudent to verify that the assumptions of ANOVA have been met. Residuals are examined or analyzed to confirm homoscedasticity and gross normality.Montgomery (2001, Section 3-4: Model adequacy checking)  Residuals should have the appearance of (zero mean normal distribution) noise when plotted as a function of anything including time and \nmodeled data values. Trends hint at interactions among factors or among observations.  One rule of thumb: \"If the largest standard deviation is less than twice the smallest standard deviation, we can use methods based on the assumption of equal standard deviations and our results \nwill still be approximately correct.\"Moore and McCabe (2003, p 755, Qualifications to this rule appear in a footnote.)\n\nFollow-up tests\n\nA statistically significant effect in ANOVA is often followed up with one or more different follow-up tests. This can be done in order to assess which groups are different from which other groups or to test various other focused hypotheses. Follow-up tests are often distinguished in terms of whether they are planned (a priori) or post hoc. Planned tests are determined before looking at the data and post hoc tests are performed after looking at the data.\n\nOften one of the \"treatments\" is none, so the treatment group can act as a control.  Dunnett's test (a modification of the t-test) tests whether each of the other treatment groups has the same \nmean as the control.Montgomery (2001, Section 3-5.8: Experiments with a single factor: The analysis of \nvariance; Practical interpretation of results; Comparing means with a control)\n\nPost hoc tests such as Tukey's range test most commonly compare every group mean with every other group mean and typically incorporate some method of controlling for Type I errors. Comparisons, which are most commonly planned, can be either simple or compound. Simple comparisons compare one group mean with one other group mean. Compound comparisons typically compare two sets of groups means where one set has two or more groups (e.g., compare average group means of group A, B and C with group D). Comparisons can also look at tests of trend, such as linear and quadratic relationships, when the independent variable involves ordered levels.\n\nFollowing ANOVA with pair-wise multiple-comparison tests has been criticized on several grounds.Hinkelmann and Kempthorne (2008, Volume 1, Section 7.5: \nComparison of Treatments; Multiple Comparison Procedures) There are many such tests (10 in one table) and recommendations regarding their use are vague or conflicting.Howell (2002, Chapter 12: Multiple comparisons among treatment means)Montgomery (2001, Section 3-5: Practical interpretation of results)\n\nStudy designs\n\nThere are several types of ANOVA. Many statisticians base ANOVA on the design of the experiment,Cochran & Cox (1957, p 9,\n\"[T]he general rule [is] that the way in which the experiment is conducted determines not only whether inferences can be made, but also the calculations required to make them.\") especially on the protocol that specifies the random assignment of treatments to subjects; the protocol's description of the assignment mechanism should include a specification of the structure of the treatments and of any blocking. It is also common to apply ANOVA to observational data using an appropriate statistical model.\n\nSome popular designs use the following types of ANOVA:\n*One-way ANOVA is used to test for differences among two or more independent groups (means),e.g. different levels of urea application in a crop, or different levels of antibiotic action on several bacterial species,[http://www.biomedicalstatistics.info/en/multiplegroups/one-way-anova.html One-way/single factor ANOVA. Biomedical Statistics]  or different levels of effect of some medicine on groups of patients. Typically, however, the one-way ANOVA is used to test for differences among at least three groups, since the two-group case can be covered by a t-test. When there are only two means to compare, the t-test and the ANOVA F-test are equivalent; the relation between ANOVA and t is given by F = t2.\n*Factorial ANOVA is used when the experimenter wants to study the interaction effects among the treatments.\n*Repeated measures ANOVA is used when the same subjects are used for each treatment (e.g., in a longitudinal study).\n*Multivariate analysis of variance (MANOVA) is used when there is more than one response variable.\n\nCautions\n\nBalanced experiments (those with an equal sample size for each treatment) are relatively easy to interpret; Unbalanced \nexperiments offer more complexity.  For single factor (one way) ANOVA, the adjustment for unbalanced data is easy, but the unbalanced analysis lacks both robustness and power.Montgomery (2001, Section 3-3.4: Unbalanced data)  For more complex designs the lack of balance leads to further complications. \"The orthogonality property of main effects and interactions present in balanced data does not carry over to the unbalanced case. This means that the usual analysis of variance techniques do not apply.  \nConsequently, the analysis of unbalanced factorials is much more difficult than that for balanced designs.\"Montgomery (2001, Section 14-2: Unbalanced data in factorial design)  In the general case, \"The analysis of variance can also be applied to unbalanced data, but then the sums of squares, mean squares, and F-ratios will depend on the order in which the sources of variation \nare considered.\"  The simplest techniques for handling unbalanced data restore balance by either throwing out data or by synthesizing missing data.  More complex techniques use regression.\n\nANOVA is (in part) a significance test.  The American Psychological Association holds the view that simply reporting significance is insufficient and that reporting confidence bounds is preferred.\n\nWhile ANOVA is conservative (in maintaining a significance level) against multiple comparisons in one dimension, it is not conservative against comparisons in multiple dimensions.Wilkinson (1999, p 600)\n\nGeneralizations\n\nANOVA is considered to be a special case of linear regressionGelman (2005, p.1) (with qualification in the later text)Montgomery (2001, Section 3.9: The Regression Approach to the Analysis of Variance) which in turn is a special case of the general linear model.Howell (2002, p 604) All consider the observations to be the sum of a model (fit) and a residual (error) to be minimized.\n\nThe Kruskal–Wallis test and the Friedman test are nonparametric tests, which  do not rely on an assumption of normality.Howell (2002, Chapter 18: Resampling and nonparametric approaches to data)Montgomery (2001, Section 3-10: Nonparametric methods in the analysis of variance)\n\nConnection to linear regression\n\nBelow we make clear the connection between multi-way ANOVA and linear regression. Linearly re-order the data so that k^\\text{th} observation is associated with a response y_k and factors Z_{k,b} where b \\in \\{1,2,\\ldots,B\\} denotes the different factors and B is the total number of factors. In one-way ANOVA B1 and in two-way ANOVA B\n2. Furthermore, we assume the b^{th} factor has I_b levels. Now, we can one-hot encode the factors into the  \\sum_{b=1}^B I_b dimensional vector v_k.\n\nThe one-hot encoding function g_b : I_b \\mapsto \\{0,1\\}^{I_b} is defined such that the i^{th} entry of g_b(Z_{k,b}) is\n\ng_b(Z_{k,b})_i \\begin{cases} 1 & \\text{if } i\nZ_{k,b} \\\\\n 0 & \\text{otherwise} \\end{cases}\n\nThe vector v_k is the concatenation of all of the above vectors for all b. Thus, v_k = [g_1(Z_{k,1}), g_2(Z_{k,2}), \\ldots, g_B(Z_{k,B})]. In order to obtain a fully general B-way interaction ANOVA we must also concatenate every additional interaction term in the vector v_k and then add an intercept term.  Let that vector be x_k.\n\nWith this notation in place, we now have the exact connection with linear regression. We simply regress response y_k against the vector X_k. However, there is a concern about identifiability. In order to overcome such issues we assume that the sum of the parameters within each set of interactions is equal to zero. From here, one can use F-statistics or other methods to determine the relevance of the individual factors.\n\nExample\n\nWe can consider the 2-way interaction example where we assume that the first factor has 2 levels and the second factor has 3 levels.\n\nDefine a_i 1 if Z_{k,1}\ni and b_i 1 if Z_{k,2}\ni, i.e. a is the one-hot encoding of the first factor and b is the one-hot encoding of the second factor.\n\nWith that,\n\nX_k = [a_1,a_2,b_1,b_2,b_3,a_1 \\times b_1,a_1 \\times b_2, a_1 \\times b_3, a_2 \\times b_1, a_2 \\times b_2, a_2 \\times b_3,1]\n\nwhere the last term is an intercept term. For a more concrete example suppose that\n\n\\begin{align}\nZ_{k,1} & = 2 \\\\\nZ_{k,2} & = 1\n\\end{align}\n\nThen,\n\nX_k = [0,1,1,0,0,0,0,0,1,0,0,1]. Analysis of variance. http://en.wikipedia.org/?curid=634."
  }
}
